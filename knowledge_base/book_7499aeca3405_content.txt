Free ebooks ==>   www.Ebook777.com
by Kevin Beaver
Foreword by Stuart McClureHacking
FOR
DUMmIES‰01 55784X FM.qxd  3/29/04  4:16 PM  Page i
www.Ebook777.com


Free ebooks ==>   www.Ebook777.com
01 55784X FM.qxd  3/29/04  4:16 PM  Page v
www.Ebook777.com


by Kevin Beaver
Foreword by Stuart McClureHacking
FOR
DUMmIES‰01 55784X FM.qxd  3/29/04  4:16 PM  Page i

Hacking For Dummies®
Published by
Wiley Publishing, Inc.111 River StreetHoboken, NJ 07030-5774
Copyright © 2004 by Wiley Publishing, Inc., Indianapolis, IndianaPublished by Wiley Publishing, Inc., Indianapolis, IndianaPublished simultaneously in CanadaNo part of this publication may be reproduced, stored in a retrieval system or transmitted in any form or
by any means, electronic, mechanical, photocopying, recording, scanning or otherwise, except as permittedunder Sections 107 or 108 of the 1976 United States Copyright Act, without either the prior written permis-sion of the Publisher, or authorization through payment of the appropriate per-copy fee to the CopyrightClearance Center, 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax (978) 646-8600. Requests tothe Publisher for permission should be addressed to the Legal Department, Wiley Publishing, Inc., 10475Crosspoint Blvd., Indianapolis, IN 46256, (317) 572-3447, fax (317) 572-4447, e-mail: 
permcoordinator@
wiley.com .
Trademarks: Wiley, the Wiley Publishing logo, For Dummies, the Dummies Man logo, A Reference for the
Rest of Us!, The Dummies Way, Dummies Daily, The Fun and Easy Way, Dummies.com, and related tradedress are trademarks or registered trademarks of John Wiley & Sons, Inc. and/or its affiliates in the UnitedStates and other countries, and may not be used without written permission. All other trademarks are theproperty of their respective owners. Wiley Publishing, Inc., is not associated with any product or vendormentioned in this book.
GENERAL DISCLAIMER:
THE PUBLISHER AND THE AUTHOR MAKE NO REPRESENTATIONS OR WAR-
RANTIES WITH RESPECT TO THE ACCURACY OR COMPLETENESS OF THE CONTENTS OF THIS WORKAND SPECIFICALLY DISCLAIM ALL WARRANTIES, INCLUDING WITHOUT LIMITATION WARRANTIESOF FITNESS FOR A PARTICULAR PURPOSE.  NO WARRANTY MAY BE CREATED OR EXTENDED BYSALES OR PROMOTIONAL MATERIALS. THE ADVICE AND STRATEGIES CONTAINED HEREIN MAY NOTBE SUITABLE FOR EVERY SITUATION. THIS WORK IS SOLD WITH THE UNDERSTANDING THAT THEPUBLISHER IS NOT ENGAGED IN RENDERING LEGAL, ACCOUNTING, OR OTHER PROFESSIONAL SER-VICES.  IF PROFESSI ONAL ASSISTANCE IS REQUIRED, THE SERVICES OF A COMPETENT PROFESSIONAL
PERSON SHOULD BE SOUGHT.  NEITHER THE PUBLISHER NOR THE AUTHOR SHALL BE LIABLE FORDAMAGES ARISING HEREFROM.  THE FACT THAT AN ORGANIZATION OR WEBSITE IS REFERRED TOIN THIS WORK AS A CITATION AND/OR A POTENTIAL SOURCE OF FURTHER INFORMATION DOES NOTMEAN THAT THE AUTHOR OR THE PUBLISHER ENDORSES THE INFORMATION THE ORGANIZATIONOR WEBSITE MAY PROVIDE OR RECOMMENDATIONS IT MAY MAKE.  FURTHER, READERS SHOULDBE AWARE THAT INTERNET WEBSITES LISTED IN THIS WORK MAY HAVE CHANGED OR DISAPPEAREDBETWEEN WHEN THIS WORK WAS WRITTEN AND WHEN IT IS READ.  
For general information on our other products and services or to obtain technical support, please contactour Customer Care Department within the U.S. at 800-762-2974, outside the U.S. at 317-572-3993, or fax317-572-4002.
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may
not be available in electronic books.
Library of Congress Control Number: 2004101971ISBN: 0-7645-5784-XManufactured in the United States of America10   9   8   7   6   5   4   3   2   11B/RV/QU/QU/IN01 55784X FM.qxd  3/29/04  4:16 PM  Page ii

Free ebooks ==>   www.Ebook777.com
About the Author
As founder and principal consultant of Principle Logic, LLC, Kevin Beaver
has over 16 years of experience in IT and specializes in information security.
Before starting his own information security services business, Kevin servedin various information technology and security roles for several Fortune 500 corporations and a variety of consulting, e-commerce, and educationalinstitutions. In addition to ethical hacking, his areas of information securityexpertise include network and wireless network security, e-mail and instantmessaging security, and incident response
Kevin is also author of the book The Definitive Guide to Email Management and
Security by Realtimepublishers.com and co-author of the book The Practical
Guide to HIPAA Privacy and Security Compliance by Auerbach Publications. In
addition, he is technical editor of the book Network Security For Dummies by
Wiley Publishing, and a contributing author and editor of the book Healthcare
Information Systems, 2
nded. by Auerbach Publications. 
Kevin is a regular columnist and information security expert advisor for
SearchSecurity.com and SearchMobileComputing.com and is a Security ClinicExpert for ITsecurity.com. In addition, his information security work has beenpublished in Information Security Magazine, HIMSS Journal of HealthcareInformation Management, Advance for Health Information Executives as wellas on SecurityFocus.com . Kevin is an information security instructor for the
Southeast Cybercrime Institute and also frequently speaks on informationsecurity at various workshops and conferences around the U.S. includingTechTarget’s Decisions conferences, CSI, and the Southeast Cybercrime
Summit.
Kevin is the founder and president of the Technology Association of Georgia’s
Information Security Society and serves as an IT advisory board member forseveral universities and companies around the southeast. Kevin earned hisbachelor’s degree in Computer Engineering Technology from Southern Poly-technic State University and his master’s degree in Management of Technologyfrom Georgia Tech. He also holds CISSP, MCSE, Master CNE, and IT Project+certifications. Kevin can be reached at 
kbeaver@principlelogic.com .01 55784X FM.qxd  3/29/04  4:16 PM  Page iii
www.Ebook777.com


Dedication
For Amy, Garrett, Master, and Murphy — through thick and thicker, we did it!
I couldn’t have written this book without the tremendous inspiration each ofyou have given me. You all make the world a better place — thanks for beinghere for me.
Author’s Acknowledgments
First, I’d like to thank Melody Layne, my acquisitions editor at Wiley, forcontacting me with this book idea, providing me this great opportunity, andfor being so patient with me during the acquisitions, writing, and editingprocesses. Also, thanks to all the other members of the acquisitions team atWiley who helped me shape my outline and initial chapter. 
I’d like to thank my project editor, Pat O’Brien, as well as Kim Darosett and the
rest of the tireless editorial staff at Wiley for all of your hard work, patience,and great edits! Also, thanks to Terri Varveris for making the initial Dummiescontact several years back in the Hungry Minds days and for introducing meto the team — you truly helped get this ball rolling. 
Major kudos go out to the security legend, Peter T. Davis, my technical editor.
Your For Dummies experience and seemingly never-ending technical knowl-
edge are a great asset to this book. I really appreciate your time and effortyou’ve put forth, and I’m truly honored that you helped me on this project.
I’d also like to thank Stuart McClure — the highly-talented security expert
and phenomenal author — for writing the foreword. It’s funny how this bookturned out and how you still ended up being involved! Just look at what youcreated instead — you should be proud.  
To Ira Winkler, Dr. Philippe Oechslin, David Rhoades, Laura Chappell, Matt
Caldwell, Thomas Akin, Ed Skoudis, and Caleb Sima — thank you all for doingsuch a great job with the case studies in this book! They’re a perfect fit andeach of you were true professionals and great to work with. I really appreciateyour time and effort.01 55784X FM.qxd  3/29/04  4:16 PM  Page iv

I’d like to extend deep gratitude to Robert Dreyer — my favorite professor at
Southern Poly — who piqued my technical interest in computer hardware andsoftware and who taught me way more about computer bits and bytes than Ithought I’d ever know. Also, thanks to my friend William Long — one of thesmartest people I’ve ever known — for being the best computer and networkmentor I could ever have. In addition, I’d like to thank John Cirami for show-ing me how to run that first DOS executable file off of that 5 1/4” floppy wayback when and for helping me to get the ball rolling in my computer career.
A well-deserved thanks also goes out to all my friends and colleagues — you
know who you are — who helped provide feedback and advice about the titlechange.
Finally, I’d like to thank Rik Emmett, Geoff Tate, Neil Peart, and allof their
supporting band members for the awesome lyrics and melodies that inspired
me to keep pushing forward with this book during the challenging times.01 55784X FM.qxd  3/29/04  4:16 PM  Page v

Publisher’s Acknowledgments
We’re proud of this book; please send us your comments through our online registration form
located at www.dummies.com/register/ .
Some of the people who helped bring this book to market include the following:
Acquisitions, Editorial, and Media Development
Project Editor: Pat O’Brien
Acquisitions Editor: Melody Layne
Senior Copy Editor: Kim Darosett
Technical Editor: Peter T. Davis
Editorial Manager: Kevin Kirschner
Media Development Manager: Laura VanWinkle
Media Development Supervisor:
Richard Graves
Editorial Assistant: Amanda Foxworth
Cartoons: Rich Tennant, 
www.the5thwave.comProduction
Project Coordinator: Maridee Ennis
Layout and Graphics: Andrea Dahl,
Denny Hager, Lynsey Osborn,Heather Ryan, Jacque Schneider
Proofreaders: Carl W. Pierce, Brian H. Walls,
TECHBOOKS Production Services
Indexer: TECHBOOKS Production Services
Publishing and Editorial for Technology Dummies
Richard Swadley, Vice President and Executive Group Publisher
Andy Cummings, Vice President and Publisher
Mary C. Corder, Editorial Director
Publishing for Consumer Dummies
Diane Graves Steele, Vice President and Publisher
Joyce Pepple, Acquisitions Director
Composition Services
Gerry Fahey, Vice President of Production Services
Debbie Stailey, Director of Composition Services01 55784X FM.qxd  3/29/04  4:16 PM  Page vi

Contents at a Glance
Foreword...................................................................xvii
Introduction .................................................................1Part I: Building the Foundation for Ethical Hacking .......7
Chapter 1: Introduction to Ethical Hacking ...................................................................9
Chapter 2: Cracking the Hacker Mindset ......................................................................21Chapter 3: Developing Your Ethical Hacking Plan .......................................................29Chapter 4: Hacking Methodology ..................................................................................39
Part II: Putting Ethical Hacking in Motion ..................53
Chapter 5: Social Engineering ........................................................................................55Chapter 6: Physical Security ..........................................................................................69Chapter 7: Passwords .....................................................................................................79
Part III: Network Hacking ........................................103
Chapter 8: War Dialing ..................................................................................................105Chapter 9: Network Infrastructure ..............................................................................117Chapter 10: Wireless LANs ...........................................................................................147
Part IV: Operating System Hacking  ..........................165
Chapter 11: Windows ....................................................................................................167Chapter 12: Linux ..........................................................................................................193Chapter 13: Novell NetWare .........................................................................................215
Part V: Application Hacking .....................................235
Chapter 14: Malware .....................................................................................................237Chapter 15: Messaging Systems ..................................................................................257Chapter 16: Web Applications .....................................................................................279
Part VI: Ethical Hacking Aftermath ..........................297
Chapter 17: Reporting Your Results ............................................................................299Chapter 18: Plugging Security Holes ...........................................................................305Chapter 19: Managing Security Changes ....................................................................31101 55784X FM.qxd  3/29/04  4:16 PM  Page vii

Free ebooks ==>   www.Ebook777.com
Part VII: The Part of Tens .........................................317
Chapter 20: Ten Tips for Getting Upper Management Buy-In ..................................319
Chapter 21: Ten Deadly Mistakes ................................................................................323
Part VIII: Appendixes ...............................................327
Appendix A: Tools and Resources................................................................................329Appendix B: About the Book Web Site.........................................................................337
Index .......................................................................33901 55784X FM.qxd  3/29/04  4:16 PM  Page viii
www.Ebook777.com


Table of Contents
Foreword ...................................................................xvii
Introduction..................................................................1
Who Should Read This Book? ........................................................................1
About This Book ..............................................................................................2How to Use This Book ....................................................................................2What You Don’t Need to Read .......................................................................3Foolish Assumptions ......................................................................................3How This Book Is Organized ..........................................................................3
Part I: Building the Foundation for Ethical Hacking ..........................4Part II: Putting Ethical Hacking in Motion ..........................................4Part III: Network Hacking ......................................................................4Part IV: Operating System Hacking .....................................................4Part V: Application Hacking .................................................................5Part VI: Ethical Hacking Aftermath .....................................................5Part VII: The Part of Tens .....................................................................5Part VIII: Appendixes ............................................................................5
Icons Used in This Book .................................................................................6Where to Go from Here ...................................................................................6
Part I: Building the Foundation for Ethical Hacking ........7
Chapter 1: Introduction to Ethical Hacking  . . . . . . . . . . . . . . . . . . . . . . .9
How Hackers Beget Ethical Hackers .............................................................9
Defining hacker ......................................................................................9Ethical Hacking 101 .............................................................................10
Understanding the Need to Hack Your Own Systems ..............................11Understanding the Dangers Your Systems Face .......................................12
Nontechnical attacks ..........................................................................12Network-infrastructure attacks .........................................................13Operating-system attacks ...................................................................13Application and other specialized attacks .......................................13
Obeying the Ethical hacking Commandments ..........................................14
Working ethically .................................................................................14Respecting privacy ..............................................................................14Not crashing your systems ................................................................15
The Ethical hacking Process ........................................................................15
Formulating your plan ........................................................................15Selecting tools ......................................................................................17Executing the plan ...............................................................................19Evaluating results ................................................................................20Moving on .............................................................................................2001 55784X FM.qxd  3/29/04  4:16 PM  Page ix

Chapter 2: Cracking the Hacker Mindset  . . . . . . . . . . . . . . . . . . . . . . . .21
What You’re Up Against ................................................................................21
Who Hacks .....................................................................................................22Why Hackers Hack ........................................................................................24Planning and Performing Attacks ................................................................26Maintaining Anonymity ................................................................................27
Chapter 3: Developing Your Ethical Hacking Plan  . . . . . . . . . . . . . . . .29
Getting Your Plan Approved ........................................................................29Establishing Your Goals ................................................................................30Determining What Systems to Hack ...........................................................32Creating Testing Standards ..........................................................................33
Timing ...................................................................................................34Specific tests ........................................................................................34Blind versus knowledge assessments ..............................................35Location ................................................................................................36Reacting to major exploits that you find ..........................................36Silly assumptions .................................................................................36
Selecting Tools ...............................................................................................37
Chapter 4: Hacking Methodology  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .39
Setting the Stage ............................................................................................39Seeing What Others See ...............................................................................41
Gathering public information ............................................................41Mapping the network ..........................................................................43
Scanning Systems ..........................................................................................45
Hosts .....................................................................................................46Modems and open ports ....................................................................46
Determining What’s Running on Open Ports .............................................47Assessing Vulnerabilities .............................................................................49Penetrating the System ................................................................................51
Part II: Putting Ethical Hacking in Motion ...................53
Chapter 5: Social Engineering  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .55
Social Engineering 101 ..................................................................................55Before You Start .............................................................................................56Why Hackers Use Social Engineering .........................................................58Understanding the Implications ..................................................................58Performing Social-Engineering Attacks ......................................................59
Fishing for information .......................................................................60Building trust .......................................................................................62Exploiting the relationship .................................................................63
Social-Engineering Countermeasures .........................................................65
Policies ..................................................................................................66User awareness ....................................................................................66Hacking For Dummies x01 55784X FM.qxd  3/29/04  4:16 PM  Page x

Chapter 6: Physical Security  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .69
Physical-Security Vulnerabilities ................................................................69
What to Look For ...........................................................................................70
Building infrastructure .......................................................................72Utilities ..................................................................................................73Office layout and usage ......................................................................74Network components and computers ..............................................75
Chapter 7: Passwords  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .79
Password Vulnerabilities ..............................................................................79
Organizational password vulnerabilities ..........................................80Technical password vulnerabilities ..................................................82
Cracking Passwords ......................................................................................82
Cracking passwords the old-fashioned way ....................................83High-tech password cracking .............................................................85General password-hacking countermeasures ..................................91Password-protected files ....................................................................95Other ways to crack passwords ........................................................97
Securing Operating Systems ......................................................................101
Windows .............................................................................................101Linux and UNIX ..................................................................................102
Part III: Network Hacking ........................................103
Chapter 8: War Dialing  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .105
War Dialing ...................................................................................................105
Modem safety .....................................................................................105General telephone-system vulnerabilities ......................................106Attacking .............................................................................................106Countermeasures ..............................................................................114
Chapter 9: Network Infrastructure  . . . . . . . . . . . . . . . . . . . . . . . . . . . .117
Network Infrastructure Vulnerabilities ....................................................119Choosing Tools ............................................................................................120
Scanners .............................................................................................120Vulnerability assessment .................................................................121
Scanning, Poking, and Prodding ................................................................121
Port scanners .....................................................................................121SNMP scanning ..................................................................................129Banner grabbing ................................................................................130Firewall rules ......................................................................................131Looking through a network analyzer ..............................................134The MAC-daddy attack .....................................................................140Denial of service ................................................................................144General network defenses ................................................................146xi Table of Contents01 55784X FM.qxd  3/29/04  4:16 PM  Page xi

Chapter 10: Wireless LANs  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .147
Understanding the Implications of Wireless Network Vulnerabilities ....147
Choosing Your Tools ...................................................................................148Wireless LAN Discovery .............................................................................151
Checking for worldwide recognition ...............................................151Scanning your local airwaves ..........................................................152
Wireless Network Attacks ..........................................................................154
Encrypted traffic ...............................................................................155Countermeasures ..............................................................................156Rogue networks .................................................................................158Countermeasures ..............................................................................159Physical-security problems ..............................................................160Countermeasures ..............................................................................160Vulnerable wireless workstations ...................................................161Countermeasures ..............................................................................161Default configuration settings .........................................................162Countermeasures ..............................................................................163
Part IV: Operating System Hacking  ..........................165
Chapter 11: Windows  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .167
Windows Vulnerabilities ............................................................................168Choosing Tools ............................................................................................168
Essential tools ....................................................................................169Free Microsoft tools ..........................................................................169All-in-one assessment tools ..............................................................170Task-specific tools .............................................................................170
Information Gathering ................................................................................171
System scanning ................................................................................171NetBIOS  ..............................................................................................174
RPC ................................................................................................................177
Enumeration .......................................................................................178Countermeasures ..............................................................................178
Null Sessions  ...............................................................................................179
Hacks ...................................................................................................179Countermeasures ..............................................................................184
Share Permissions .......................................................................................186
Windows defaults ..............................................................................186Testing ................................................................................................187
General Security Tests ................................................................................189
Windows Update ................................................................................189Microsoft Baseline Security Analyzer (MBSA) ...............................190LANguard ............................................................................................191
Chapter 12: Linux  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .193
Linux Vulnerabilities ...................................................................................194Choosing Tools ............................................................................................194Hacking For Dummies xii01 55784X FM.qxd  3/29/04  4:16 PM  Page xii

Information Gathering ................................................................................195
System scanning ................................................................................195
Countermeasures ..............................................................................199
Unneeded Services .....................................................................................200
Searches ..............................................................................................200Countermeasures ..............................................................................202
.rhosts and hosts.equiv Files .....................................................................204
Hacks ...................................................................................................204Countermeasures ..............................................................................205
NFS ................................................................................................................206
Hacks ...................................................................................................206Countermeasures ..............................................................................207
File Permission ............................................................................................207
Hacks ...................................................................................................207Countermeasures ..............................................................................207
Buffer Overflows .........................................................................................208
Attacks ................................................................................................209Countermeasures ..............................................................................209
Physical Security .........................................................................................209
Hacks ...................................................................................................210Countermeasures ..............................................................................210
General Security Tests ................................................................................211Patching Linux .............................................................................................212
Distribution updates .........................................................................213Multiplatform update managers ......................................................213
Chapter 13: Novell NetWare  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .215
NetWare Vulnerabilities ..............................................................................215Choosing Tools ............................................................................................216Getting Started ............................................................................................216
Server access methods .....................................................................217Port scanning .....................................................................................217NCPQuery ...........................................................................................219Countermeasures ..............................................................................220
Authentication .............................................................................................220
Rconsole .............................................................................................221Server-console access ......................................................................224Intruder detection .............................................................................224Rogue NLMs .......................................................................................225Clear-text packets ..............................................................................229
General Best Practices for Minimizing NetWare Security Risks ............230
Rename admin ...................................................................................231Disable eDirectory browsing ...........................................................231Removing bindery contexts .............................................................233System auditing .................................................................................233TCP/IP parameters ............................................................................234Patching ..............................................................................................234xiii Table of Contents01 55784X FM.qxd  3/29/04  4:16 PM  Page xiii

Part V: Application Hacking .....................................235
Chapter 14: Malware  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .237
Implications of Malware Attacks ...............................................................237
Types of Malware ........................................................................................239
Trojan horses .....................................................................................239Viruses ................................................................................................240Worms .................................................................................................240Rootkits ...............................................................................................240Spyware ..............................................................................................241Built-in programming interfaces ......................................................241Logic bombs .......................................................................................242Security tools .....................................................................................242
How Malware Propagates ...........................................................................243
Automation .........................................................................................243E-mail ...................................................................................................243Hacker backdoors .............................................................................244
Testing ..........................................................................................................244
Vulnerable malware ports ................................................................244Manual assessment ...........................................................................245Antivirus software testing ................................................................249Network scanning ..............................................................................250Behavioral-analysis tools .................................................................253
Malware Countermeasures ........................................................................253
General system administration .......................................................253E-mails .................................................................................................255Files .....................................................................................................255
Chapter 15: Messaging Systems  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .257
Messaging-System Vulnerabilities .............................................................257E-Mail Attacks ..............................................................................................258
E-mail bombs .....................................................................................258Banners ...............................................................................................263SMTP attacks .....................................................................................265General best practices for minimizing e-mail security risks ........271
Instant Messaging .......................................................................................272
Vulnerabilities ....................................................................................272Countermeasures ..............................................................................275
Chapter 16: Web Applications  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .279
Web-Application Vulnerabilities ................................................................279Choosing Your Tools ...................................................................................280Insecure Login Mechanisms ......................................................................280
Testing ................................................................................................280Countermeasures ..............................................................................283
Directory Traversal .....................................................................................283
Testing ................................................................................................283Countermeasures ..............................................................................285Hacking For Dummies xiv01 55784X FM.qxd  3/29/04  4:16 PM  Page xiv

Input Filtering ..............................................................................................285
Input attacks ......................................................................................286
Countermeasures ..............................................................................289
Default Scripts .............................................................................................289
Attacks ................................................................................................289Countermeasures ..............................................................................290
URL Filter Bypassing ...................................................................................290
Bypassing filters ................................................................................290Countermeasures ..............................................................................292
Automated Scans ........................................................................................292
Nikto ....................................................................................................292WebInspect .........................................................................................292
General Best Practices for Minimizing 
Web-Application Security Risks .............................................................294
Obscurity ............................................................................................294Firewalls ..............................................................................................295
Part VI: Ethical Hacking Aftermath ...........................297
Chapter 17: Reporting Your Results  . . . . . . . . . . . . . . . . . . . . . . . . . . . .299
Pulling the Results Together ......................................................................299Prioritizing Vulnerabilities .........................................................................301Reporting Methods .....................................................................................302
Chapter 18: Plugging Security Holes  . . . . . . . . . . . . . . . . . . . . . . . . . .305
Turning Your Reports into Action .............................................................305Patching for Perfection ...............................................................................306
Patch management ............................................................................306Patch automation ..............................................................................307
Hardening Your Systems ............................................................................308Assessing Your Security Infrastructure ....................................................309
Chapter 19: Managing Security Changes  . . . . . . . . . . . . . . . . . . . . . . .311
Automating the Ethical Hacking Process .................................................311Monitoring Malicious Use ..........................................................................312Outsourcing Ethical Hacking .....................................................................313Instilling a Security-Aware Mindset ..........................................................315Keeping Up with Other Security Issues ....................................................316
Part VII: The Part of Tens ..........................................317
Chapter 20: Ten Tips for Getting Upper Management Buy-In  . . . . . .319
Cultivate an Ally and Sponsor ...................................................................319Don’t Be a FUDdy Duddy ............................................................................319Demonstrate How the Organization Can’t Afford to Be Hacked ...........320Outline the General Benefits of Ethical Hacking .....................................320xv Table of Contents01 55784X FM.qxd  3/29/04  4:16 PM  Page xv

Show How Ethical Hacking Specifically Helps the Organization ...........321
Get Involved in the Business .....................................................................321Establish Your Credibility ..........................................................................321Speak on Their Level ..................................................................................322Show Value in Your Efforts .........................................................................322Be Flexible and Adaptable .........................................................................322
Chapter 21: Ten Deadly Mistakes  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .323
Not Getting Approval in Writing ................................................................323Assuming That You Can Find All Vulnerabilities During Your Tests ....324Assuming That You Can Eliminate All Security Vulnerabilities .............324Performing Tests Only Once ......................................................................324Pretending to Know It All ...........................................................................325Running Your Tests without Looking at Things 
from a Hacker’s Viewpoint .....................................................................325
Ignoring Common Attacks ..........................................................................325Not Using the Right Tools ..........................................................................325Pounding Production Systems at the Wrong Time .................................326Outsourcing Testing and Not Staying Involved .......................................326
Part VIII: Appendixes ...............................................327
Appendix A: Tools and Resources  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .329
Awareness and Training .............................................................................329Dictionary Files and Word Lists ................................................................329General Research Tools ..............................................................................330Hacker Stuff ..................................................................................................330Linux .............................................................................................................331Log Analysis .................................................................................................331Malware ........................................................................................................331Messaging .....................................................................................................332NetWare ........................................................................................................332Networks ......................................................................................................332Password Cracking ......................................................................................333War Dialing ...................................................................................................334Web Applications ........................................................................................334Windows .......................................................................................................334Wireless Networks ......................................................................................335
Appendix B: About the Book Web Site  . . . . . . . . . . . . . . . . . . . . . . . . .337
Index........................................................................339Hacking For Dummies xvi01 55784X FM.qxd  3/29/04  4:16 PM  Page xvi

Foreword 
Little more than 10 years ago, security was barely a newborn in diapers.
With only a handful of security professionals in 1994, few practiced secu-
rity and even fewer truly understood it. Security technologies amounted tolittle more than anti-virus software and packet filtering routers at that time.And the concept of a “hacker” came primarily from the Hollywood movie “WarGames”; or more often it referred to someone with a low golf score. As a result,just like Rodney Dangerfield it got “no respect” and no one took it seriously.IT professionals saw it largely as a nuisance, to be ignored — that is untilthey were impacted by it.
Today, the number of Certified Information Systems Security Professionals
(CISSP) have topped 23,000 (www.isc2.org) worldwide, and there are moresecurity companies dotting the landscape than anyone could possibly remem-ber. Today security technologies encompass everything from authenticationand authorization, to firewalls and VPNs. There are so many ways to addressthe security problem that it can cause more than a slight migraine simply con-sidering the alternatives. And the term “hacker” has become a permanent partof our everyday vernacular — as defined in nearly daily headlines. The world(and its criminals) has changed dramatically.
So what does all this mean for you, the home/end user or IT/security profes-
sional that is thrust into this dangerous online world every time you hit thepower button on your computer? The answer is “everything”. The digitallandscape is peppered with land mines that can go off with the slightesttouch or, better yet, without any provocation whatsoever. Consider somesimple scenarios: 
/H12012Simply plugging into the Internet without a properly configured firewallcan get you hacked before the pizza is delivered, within 30 minutes or less.
/H12012Opening an email attachment from a family member, friend, or work col-league can install a backdoor on your system allowing a hacker freeaccess to your computer. 
/H12012Downloading and executing a file via your Internet Messaging (IM) pro-gram can turn your pristine desktop into a Centers for Disease Control(CDC) hotzone, complete with the latest alphabet soup virus. 
/H12012Browsing to an innocent (and trusted) website can completely compro-mise your computer, allowing a hacker to read your sensitive files orworse delete them. 01 55784X FM.qxd  3/29/04  4:16 PM  Page xvii

Free ebooks ==>   www.Ebook777.com
Trust me when we say the likelihood of becoming an Internet drive-by statistic
on the information superhighway is painfully real. 
I am often asked, “Is the fear, uncertainty, and doubt (FUD) centered on cybert-
errorism justified? Can cyber-terrorists really affect our computer systems
and our public infrastructure as some have prognosticated like new ageNostradamus soothsayers? The answer I always give is “Unequivocally, yes”.The possibility of a digital Pearl Harbor is closer than many think. Organizedterrorist cells like Al Qaeda are raided almost weekly, and when computers arediscovered, their drives are filled with cyber hacking plans, U.S. infrastructureblueprints, and instructions on attacking U.S. computer and infrastructuretargets. 
Do you believe the energy commissions report about the biggest power outage
in U.S history? The one that on August 14, 2003 left 1/5
thof the U.S. population
without power (about 50 million people) for over 12 hours? Do you believe thatit has to do with untrimmed trees and faulty control processes? If you believein Occam’s Razor, then yes, the simplest explanation is usually the correct onebut remember this: the power outage hit just three days after the MicrosoftBlaster worm, one of the most vicious computer worms ever unleashed onthe Internet, first hit. Coincidence? Perhaps.
Some of you may be skeptical, saying “Well, if the threat is so real, why hasn’t
something bad happened yet?” I respond simply, “If I had come to you onSept. 10, 2001, and said that in the near future people would use commercialairplanes as bombs to kill over 3,000 people in the matter of 5 hours, wouldyou believe me?” I understand your skepticism. And you should be skeptical.But we are asking for your trust, and your faith, before something bad happens.Trust that we know the truth, we know what is possible, and we know themind of the enemy. I think we can all agree on at least one thing, we cannotallow them to succeed.
Every minute of every day there are governments, organized crime, and hacker
groups turning the doors on your house looking for an unlocked entry. Theyare rattling the windows and circling your domicile, looking for a weakness, avulnerability, or a way into your house. Are you going to let them in? Are yougoing to sit idly by and watch as they ransack your belongings, make use ofyour facilities, and desecrate your sanctuary? Or are you going to empoweryourself, educate yourself, and prevent them from winning? The actions youtake today will ultimately answer that question.
Do not despair, all hope is not lost. Increasing security is more of a mindset
than anything else. Security is akin to working out. If you don’t do it regularly,it won’t become a part of your lifestyle. And if it doesn’t become a part of yourlifestyle, it will quickly become something you can forego and avoid. In otherwords, you won’t be fit. Same thing applies for security. If you don’t realize thatit is a process, not a goal, then you will never make it part of your everydaywellness routine, as a result it quickly becomes something you forego andavoid. And if you avoid it, you will eventually be bit by it.Hacking For Dummies xviii01 55784X FM.qxd  3/29/04  4:16 PM  Page xviii
www.Ebook777.com


The greatest gift you can give yourself is that of education. What you don’t
know may not kill you but it may seriously impact you or someone you careabout. Knowing what you don’t know is the real trick. And filling in the gapsof knowledge is paramount to preventing a significant attack.  Hacking For
Dummies can fill in those gaps. Kevin has done a remarkable job in presenting
material that is valuable and unique in that it covers  hacking methodologiesfor Windows, Novell, and Linux, as well as such little covered topics as physi-cal security, social engineering, and malware. The varied coverage of securitytopics in this book is what helps you more completely understand the mindof the hacker and how they work; and it will ultimately be the singular reasonyou may avoid an attack in the future. Read it carefully. Learn from it. Andpractice what it says in every area you can.
Make no mistake; the digital battlefield is very real. It has no beginning, it has
no ending, it has no boundaries, and it has no rules. Read this book, learnfrom it and defend yourself or we may lose this digital war.
Stuart McClure is a world-renowned information security expert, founder and co-
author of the highly-popular Hacking Exposed series of books, and founder andPresident and Chief Technology Officer of Foundstone, Inc., experts in strategicsecurity. He can be reached at stu@foundstone.com.xix Foreword01 55784X FM.qxd  3/29/04  4:16 PM  Page xix

Hacking For Dummies xx01 55784X FM.qxd  3/29/04  4:16 PM  Page xx

Introduction
Welcome to Hacking For Dummies. This book outlines computer hacker
tricks and techniques — in plain English — to assess the security of
your own information systems, find security vulnerabilities, and fix the vul-
nerabilities before malicious and criminal hackers have an opportunity totake advantage of them. This hacking is the professional, aboveboard, andlegal type of security testing — which I call ethical hacking throughout the
book .Computer and network security is a complex subject and an ever-
moving target. You must stay on top of it to ensure your information is pro-tected from the bad guys.
You can implement all the security technologies and other best practices
possible, and your information systems may be secure — as far as you know.However, until you understand how hackers think and apply that knowledgeto assess your systems from a hacker’s-eye view, you can’t get a true sense ofhow secure your information really is.
Ethical hacking — sometimes referred to as penetration testing or white-hat
hacking — is a necessary requirement to ensure that information systems are
truly secure on an ongoing basis. This book provides you with the knowledge
required to successfully implement an ethical hacking program, along withcountermeasures that you can implement to keep malicious hackers out ofyour business.
Who Should Read This Book?
If you want to hack other people’s computer systems maliciously, this book isnot for you.
Disclaimer: If you choose to use the information in this book to hack or break
into computer systems maliciously in an unauthorized fashion, you’re on your
own. Neither I, as the author, nor anyone else associated with this book shall
be liable or responsible for any unethical or criminal choices that you maymake and execute using the methodologies and tools that I describe. Thisbook is intended solely for the IT professional to test information security inan authorized fashion.02 55784x intro.qxd  3/29/04  4:16 PM  Page 1

Okay, now that that’s out of the way, time for the good stuff! This book is for
you if you’re a network administrator, information-security manager, securityconsultant, or someone interested in finding out more about legally and ethi-cally hacking your own or a customer’s information systems to make themmore secure.
As the ethical hacker performing well-intended information-security assess-
ments, you can detect and point out security holes that may otherwise beoverlooked. If you’re performing these tests on your own systems, the infor-mation you uncover in your tests can help you win over management andprove that information security should be taken seriously. Likewise, if you’reperforming these tests for your customers, you can help find security holesthat can be plugged before malicious hackers have a chance to exploit them.
The information in this book helps you stay on top of the security game and
enjoy the fame and glory that comes with helping your organization and cus-tomers prevent bad things from happening to their information.
About This Book
Hacking For Dummies is a reference guide on hacking computers and network
systems. The ethical hacking techniques are based on the unwritten rules ofcomputer system penetration testing and information-security best practices.This book covers everything from establishing your hacking plan to testingyour systems to managing an ongoing ethical hacking program. Realistically,for many networks, operating systems, and applications, thousands of possi-ble hacks exist. I cover the major ones that you should be concerned about.Whether you need to assess security vulnerabilities on a small home-officenetwork, a medium-size corporate network, or across large enterprise sys-tems, Hacking For Dummies provides the information you need.
How to Use This Book
This book includes the following features:
/H12012Various technical and nontechnical hack attacks and their detailedmethodologies
/H12012Hack-attack case studies from well-known and anonymous hackers andother security experts
/H12012Specific countermeasures to protect against hack attacks
Each chapter is an individual reference on a specific ethical hacking subject.You can refer to individual chapters that pertain to the type of systems you’re
assessing, or you can read the book straight through. 2 Hacking For Dummies 02 55784x intro.qxd  3/29/04  4:16 PM  Page 2

Before you start hacking your systems, familiarize yourself with the informa-
tion in Part I so you’re prepared for the tasks at hand. The adage “if you failto plan, you plan to fail” rings true for the ethical hacking process. You mustget written permission and have a solid game plan.
This material is not intended to be used for unethical or illegal hacking pur-
poses to propel you from script kiddie to mega hacker. Rather, it is designedto provide you with the knowledge you need to hack your own or your cus-tomers’ systems — in an ethical and legal manner — to enhance the securityof the information involved.
What You Don’t Need to Read
Depending on your computer and network configurations, you may be able toskip chapters. For example, if you aren’t running Linux or wireless networks,you can skip those chapters.
Foolish Assumptions
I make a few assumptions about you, aspiring information-security person:
/H12012You’re familiar with basic computer-, network-, and information-security-related concepts and terms.
/H12012You have a basic understanding of what hackers do.
/H12012You have access to a computer and a network on which to test thesetechniques.
/H12012You have access to the Internet in order to obtain the various tools usedin the ethical hacking process.
/H12012You have permission to perform the hacking techniques in this book.
How This Book Is Organized
This book is organized into eight parts — six regular chapter parts, a Part ofTens, and a part with appendixes. These parts are modular, so you can jumparound from one part to another as needed. Each chapter provides practicalmethodologies and best practices you can utilize as part of your ethical hack-ing efforts, including checklists and references to specific tools you can use,as well as resources on the Internet.3 Introduction02 55784x intro.qxd  3/29/04  4:16 PM  Page 3

Part I: Building the Foundation
for Ethical Hacking
This part covers the fundamental aspects of ethical hacking. It starts with an
overview of the value of ethical hacking and what you should and shouldn’tdo during the process. You get inside the hacker’s mindset and discover howto plan your ethical hacking efforts. This part covers the steps involved inthe ethical hacking process, including how to choose the proper tools.
Part II: Putting Ethical Hacking in Motion
This part gets you rolling with the ethical hacking process. It covers severalwell-known hack attacks, including social engineering and cracking pass-words, to get your feet wet. The techniques presented are some of the mostwidely used hack attacks. This part covers the human and physical elementsof security, which tend to be the weakest links in any information-securityprogram. After you plunge into these topics, you’ll know the tips and tricksrequired to perform common general hack attacks against your systems, aswell as specific countermeasures to keep your information systems secure.
Part III: Network Hacking
Starting with the larger network in mind, this part covers methods to testyour systems for various well-known network infrastructure vulnerabilities.From weaknesses in the TCP/IP protocol suite to wireless network insecuri-ties, you find out how networks are compromised using specific methods offlawed network communications, along with various countermeasures thatyou can implement to keep from becoming a victim. This part also includescase studies on some of the network hack attacks that are presented.
Part IV: Operating System Hacking
Practically all operating systems have well-known vulnerabilities that hackersoften use. This part jumps into hacking three widely used operating systems:Windows, Linux, and NetWare. The hacking methods include scanning youroperating systems for vulnerabilities and enumerating the specific hosts togain detailed information. This part also includes information on exploitingwell-known vulnerabilities in these operating systems, taking over operatingsystems remotely, and specific countermeasures that you can implement tomake your operating systems more secure. This part also includes case stud-ies on operating-system hack attacks.4 Hacking For Dummies 02 55784x intro.qxd  3/29/04  4:16 PM  Page 4

Part V: Application Hacking
Application security is gaining more visibility in the information-security arena
these days. An increasing number of attacks are aimed directly at variousapplications, which are often able to bypass firewalls, intrusion-detectionsystems, and antivirus software. This part discusses hacking specific appli-cations, including coverage on malicious software and messaging systems,along with practical countermeasures that you can put in place to make yourapplications more secure. 
One of the most common network attacks is on Web applications. Practically
every firewall lets Web traffic into and out of the network, so most attacks areagainst the millions of Web applications available to almost anyone. This partcovers Web application hack attacks, countermeasures, and some applicationhacking case studies for real-world security testing scenarios.
Part VI: Ethical Hacking Aftermath
After you’ve performed your ethical hack attacks, what do you do with theinformation you’ve gathered? Shelve it? Show it off? How do you move for-ward? This part answers all these questions and more. From developingreports for upper management to remediating the security flaws that you dis-cover to establishing procedures for your ongoing ethical hacking efforts,this part brings the ethical hacking process full circle. This information notonly ensures that your effort and time are well spent, but also is evidencethat information security is as an essential element for success in any busi-ness that depends on computers and information technology.
Part VII: The Part of Tens
This part contains tips to help ensure the success of your ethical hackingprogram. You find out how to get upper management to buy into your ethicalhacking program so you can get going and start protecting your systems. Thispart also includes the top ten ethical hacking mistakes to avoid and my topten tips for ethical hacking success. 
Part VIII: Appendixes
This part includes two appendixes that cover ethical hacking reference mate-rials. This includes a one-stop reference listing of ethical hacking tools andresources, as well as information on the Hacking For Dummies Web site.5 Introduction02 55784x intro.qxd  3/29/04  4:16 PM  Page 5

Icons Used in This Book
This icon points out technical information that is interesting but not vital to
your understanding of the topic being discussed.
This icon points out information that is worth committing to memory.This icon points out information that could have a negative impact on your
ethical hacking efforts — so please read it!
This icon refers to advice that can help highlight or clarify an important
point.
Where to Go from Here
The more you know about how hackers work and how your systems shouldbe tested, the better you’re able to secure your computer systems. This bookprovides the foundation that you need to develop and maintain a successfulethical-hacking program for your organization and customers. Keep in mindthat the high-level concepts of ethical hacking won’t change as often as thespecific information-security vulnerabilities you’re protecting against. The artand science of ethical hacking will always remain an art and a science — anda field that’s ever-changing. You must keep up with the latest hardware andsoftware technologies, along with the various vulnerabilities that come aboutyear after year. No one best way to hack your systems ethically exists, sotweak this information to your heart’s content. Happy (ethical) hacking!6 Hacking For Dummies 02 55784x intro.qxd  3/29/04  4:16 PM  Page 6

Part I
Building the
Foundation for
Ethical Hacking03 55784X PP01.qxd  3/29/04  4:16 PM  Page 7

In this part . . .Your mission — should you choose to accept it — is to
find the holes in your network before the bad guys do.
This mission will be fun, educational, and most likely enter-taining. It will certainly be an eye-opening experience. The
cool part is that you can emerge as the hero, knowing thatyour company will be better protected against hackerattacks and less likely to have its name smeared acrossthe headlines at any time.
If you’re new to ethical hacking, this is the place to begin.
The chapters in this part will get you started with informa-tion on what to do and how to do it when you’re hackingyour own systems. Oh, and also, you ﬁnd out what notto
do as well. This information will guide you through buildingthe foundation for your ethical hacking program to makesure you’re going down the right path so you don’t veeroff and end up going down a one-way dead-end street.03 55784X PP01.qxd  3/29/04  4:16 PM  Page 8

Chapter 1
Introduction to Ethical Hacking
In This Chapter
/H17075Understanding hacker objectives
/H17075Outlining the differences between ethical hackers and malicious hackers
/H17075Examining how the ethical hacking process has come about
/H17075Understanding the dangers that your computer systems face
/H17075Starting the ethical hacking process
This book is about hacking ethically — the science of testing your comput-
ers and network for security vulnerabilities and plugging the holes you
find before the bad guys get a chance to exploit them.
Although ethical is an often overused and misunderstood word, the Merriam-
Webster dictionary defines ethical perfectly for the context of this book and
the professional security testing techniques that I cover — that is, conforming
to accepted professional standards of conduct . IT practitioners are obligated to
perform all the tests covered in this book aboveboard and only after permis-
sion has been obtained by the owner(s) of the systems — hence the dis claimer
in the introduction.
How Hackers Beget Ethical Hackers
We’ve all heard of hackers. Many of us have even suffered the consequencesof hacker actions. So who are these hackers? Why is it important to knowabout them? The next few sections give you the lowdown on hackers.
Defining hacker
Hacker is a word that has two meanings:
/H12012Traditionally, a hacker is someone who likes to tinker with software orelectronic systems. Hackers enjoy exploring and learning how computersystems operate. They love discovering new ways to work electronically.04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 9

/H12012Recently, hacker has taken on a new meaning — someone who mali ciously
breaks into systems for personal gain. Technically, these criminals are
crackers (criminal hackers). Crackers break into (crack) systems with
malicious intent. They are out for personal gain: fame, profit, and evenrevenge. They modify, delete, and steal critical information, often makingother people miserable.
The good-guy (white-hat) hackers don’t like being in the same category as the
bad-guy (black-hat) hackers. (These terms come from Western movies where
the good guys wore white cowboy hats and the bad guys wore black cowboyhats.) Whatever the case, most people give hacker a negative connotation.
Many malicious hackers claim that they don’t cause damage but instead arealtruistically helping others. Yeah, right. Many malicious hackers are elec-tronic thieves.
In this book, I use the following terminology:
/H12012Hackers (or bad guys ) try to compromise computers .
/H12012Ethical hackers (or good guys ) protect computers against illicit entry .
Hackers go for almost any system they think they can compromise. Some
prefer prestigious, well-protected systems, but hacking into anyone’s systemincreases their status in hacker circles.
Ethical Hacking 101
You need protection from hacker shenanigans. An ethical hacker possesses
the skills, mindset, and tools of a hacker but is also trustworthy. Ethical hack-ers perform the hacks as security tests for their systems.
If you perform ethical hacking tests for customers or simply want to add
another certification to your credentials, you may want to consider the ethi-cal hacker certification Certified Ethical Hacker, which is sponsored by EC-Council. See 
www.eccouncil.org/CEH.htm for more information.
Ethical hacking — also known as penetration testing or white-hat hacking —
involves the same tools, tricks, and techniques that hackers use, but with onemajor difference: Ethical hacking is legal. Ethical hacking is performed withthe target’s permission. The intent of ethical hacking is to discover vulnera-bilities from a hacker’s viewpoint so systems can be better secured. It’s partof an overall information risk management program that allows for ongoingsecurity improvements. Ethical hacking can also ensure that vendors’ claimsabout the security of their products are legitimate.10 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 10

To hack your own systems like the bad guys, you must think like they think.
It’s absolutely critical to know your enemy; see Chapter 2 for details.
Understanding the Need to
Hack Your Own Systems
To catch a thief, think like a thief. That’s the basis for ethical hacking.
The law of averages works against security. With the increased numbers and
expanding knowledge of hackers combined with the growing number of systemvulnerabilities and other unknowns, the time will come when all computersystems are hacked or compromised in some way. Protecting your systemsfrom the bad guys — and not just the generic vulnerabilities that everyoneknows about — is absolutely critical. When you know hacker tricks, you cansee how vulnerable your systems are.
Hacking preys on weak security practices and undisclosed vulnerabilities.
Firewalls, encryption, and virtual private networks (VPNs) can create a falsefeeling of safety. These security systems often focus on high-level vulnerabili-ties, such as viruses and traffic through a firewall, without affecting how hack-ers work. Attacking your own systems to discover vulnerabilities is a step tomaking them more secure. This is the only proven method of greatly hardeningyour systems from attack. If you don’t identify weaknesses, it’s a matter oftime before the vulnerabilities are exploited.
As hackers expand their knowledge, so should you. You must think like them
to protect your systems from them. You, as the ethical hacker, must knowactivities hackers carry out and how to stop their efforts. You should knowwhat to look for and how to use that information to thwart hackers’ efforts.
You don’t have to protect your systems from everything. You can’t. The only
protection against everything is to unplug your computer systems and lockthem away so no one can touch them — not even you. That’s not the bestapproach to information security. What’s important is to protect your sys-tems from known vulnerabilities and common hacker attacks.
It’s impossible to buttress all possible vulnerabilities on all your systems. You
can’t plan for all possible attacks — especially the ones that are currentlyunknown. However, the more combinations you try — the more you test wholesystems instead of individual units — the better your chances of discoveringvulnerabilities that affect everything as a whole.
Don’t take ethical hacking too far, though. It makes little sense to harden your
systems from unlikely attacks. For instance, if you don’t have a lot of foot traffic11 Chapter 1: Introduction to Ethical Hacking04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 11

in your office and no internal Web server running, you may not have as much
to worry about as an Internet hosting provider would have. However, don’tforget about insider threats from malicious employees!
Your overall goals as an ethical hacker should be as follows:
/H12012Hack your systems in a nondestructive fashion.
/H12012Enumerate vulnerabilities and, if necessary, prove to upper management
that vulnerabilities exist.
/H12012Apply results to remove vulnerabilities and better secure your systems.
Understanding the Dangers
Your Systems Face
It’s one thing to know that your systems generally are under fire from hackers
around the world. It’s another to understand specific attacks against your sys-tems that are possible. This section offers some well-known attacks but is byno means a comprehensive listing. That requires its own book: Hack Attacks
Encyclopedia, by John Chirillo (Wiley Publishing, Inc.) .
Many information-security vulnerabilities aren’t critical by themselves.However, exploiting several vulnerabilities at the same time can take its toll.For example, a default Windows OS configuration, a weak SQL Server admin-istrator password, and a server hosted on a wireless network may not bemajor security concerns separately. But exploiting all three of these vulnera-bilities at the same time can be a serious issue.
Nontechnical attacks
Exploits that involve manipulating people — end users and even yourself —are the greatest vulnerability within any computer or network infrastructure.Humans are trusting by nature, which can lead to social-engineering exploits.Social engineering is defined as the exploitation of the trusting nature of human
beings to gain information for malicious purposes. I cover social engineeringin depth in Chapter 5.
Other common and effective attacks against information systems are physical.
Hackers break into buildings, computer rooms, or other areas containing crit-ical information or property. Physical attacks can include dumpster diving
(rummaging through trash cans and dumpsters for intellectual property,passwords, network diagrams, and other information).12 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 12

Free ebooks ==>   www.Ebook777.com
Network-infrastructure attacks
Hacker attacks against network infrastructures can be easy, because many
networks can be reached from anywhere in the world via the Internet. Hereare some examples of network-infrastructure attacks:
/H12012Connecting into a network through a rogue modem attached to acomputer behind a firewall
/H12012Exploiting weaknesses in network transport mechanisms, such as TCP/IPand NetBIOS
/H12012Flooding a network with too many requests, creating a denial of service(DoS) for legitimate requests
/H12012Installing a network analyzer on a network and capturing every packetthat travels across it, revealing confidential information in clear text
/H12012Piggybacking onto a network through an insecure 802.11b wirelessconfiguration
Operating-system attacks
Hacking operating systems (OSs) is a preferred method of the bad guys. OSscomprise a large portion of hacker attacks simply because every computerhas one and so many well-known exploits can be used against them.
Occasionally, some operating systems that are more secure out of the box —
such as Novell NetWare and the flavors of BSD UNIX — are attacked, andvulnerabilities turn up. But hackers prefer attacking operating systems likeWindows and Linux because they are widely used and better known for theirvulnerabilities.
Here are some examples of attacks on operating systems:
/H12012Exploiting specific protocol implementations
/H12012Attacking built-in authentication systems
/H12012Breaking file-system security
/H12012Cracking passwords and encryption mechanisms
Application and other specialized attacks
Applications take a lot of hits by hackers. Programs such as e-mail server
software and Web applications often are beaten down:13 Chapter 1: Introduction to Ethical Hacking04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 13
www.Ebook777.com


/H12012Hypertext Transfer Protocol (HTTP) and Simple Mail Transfer Protocol
(SMTP) applications are frequently attacked because most firewalls andother security mechanisms are configured to allow full access to theseprograms from the Internet.
/H12012Malicious software (malware) includes viruses, worms, Trojan horses,
and spyware. Malware clogs networks and takes down systems.
/H12012Spam (junk e-mail) is wreaking havoc on system availability and storage
space. And it can carry malware.
Ethical hacking helps reveal such attacks against your computer systems.Parts II through V of this book cover these attacks in detail, along with spe-cific countermeasures you can implement against attacks on your systems.
Obeying the Ethical Hacking
Commandments
Every ethical hacker must abide by a few basic commandments. If not, bad
things can happen. I’ve seen these commandments ignored or forgotten whenplanning or executing ethical hacking tests. The results weren’t positive.
Working ethically
The word ethical in this context can be defined as working with high profes-
sional morals and principles. Whether you’re performing ethical hacking testsagainst your own systems or for someone who has hired you, everything youdo as an ethical hacker must be aboveboard and must support the company’sgoals. No hidden agendas are allowed!
Trustworthiness is the ultimate tenet. The misuse of information is absolutely
forbidden. That’s what the bad guys do.
Respecting privacy
Treat the information you gather with the utmost respect. All information
you obtain during your testing — from Web-application log files to clear-textpasswords — must be kept private. Don’t use this information to snoop intoconfidential corporate information or private lives. If you sense that someoneshould know there’s a problem, consider sharing that information with theappropriate manager.14 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 14

Involve others in your process. This is a “watch the watcher” system that can
build trust and support your ethical hacking projects.
Not crashing your systems
One of the biggest mistakes I’ve seen when people try to hack their own sys-tems is inadvertently crashing their systems. The main reason for this is poorplanning. These testers have not read the documentation or misunderstandthe usage and power of the security tools and techniques.
You can easily create DoS conditions on your systems when testing. Running
too many tests too quickly on a system causes many system lockups. I knowbecause I’ve done this! Don’t rush things and assume that a network or spe-cific host can handle the beating that network scanners and vulnerability-assessment tools can dish out.
Many security-assessment tools can control how many tests are performed
on a system at the same time. These tools are especially handy if you need torun the tests on production systems during regular business hours.
You can even create an account or system lockout condition by social engi-
neering someone into changing a password, not realizing that doing so mightcreate a system lockout condition.
The Ethical Hacking Process
Like practically any IT or security project, ethical hacking needs to be plannedin advance. Strategic and tactical issues in the ethical hacking process shouldbe determined and agreed upon. Planning is important for any amount oftesting — from a simple password-cracking test to an all-out penetration teston a Web application.
Formulating your plan
Approval for ethical hacking is essential. Make what you’re doing known andvisible — at least to the decision makers. Obtaining sponsorship of the project
is the first step. This could be your manager, an executive, a customer, oreven yourself if you’re the boss. You need someone to back you up and signoff on your plan. Otherwise, your testing may be called off unexpectedly ifsomeone claims they never authorized you to perform the tests.15 Chapter 1: Introduction to Ethical Hacking04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 15

The authorization can be as simple as an internal memo from your boss if
you’re performing these tests on your own systems. If you’re testing for acustomer, have a signed contract in place, stating the customer’s support and
authorization. Get written approval on this sponsorship as soon as possibleto ensure that none of your time or effort is wasted. This documentation isyour Get Out of Jail Free card if anyone questions what you’re doing.
You need a detailed plan, but that doesn’t mean you have to have volumes oftesting procedures. One slip can crash your systems — not necessarily whatanyone wants. A well-defined scope includes the following information:
/H12012Specific systems to be tested
/H12012Risks that are involved
/H12012When the tests are performed and your overall timeline
/H12012How the tests are performed
/H12012How much knowledge of the systems you have before you start testing
/H12012What is done when a major vulnerability is discovered
/H12012The specific deliverables — this includes security-assessment reportsand a higher-level report outlining the general vulnerabilities to beaddressed, along with countermeasures that should be implemented
When selecting systems to test, start with the most critical or vulnerablesystems. For instance, you can test computer passwords or attempt social-engineering attacks before drilling down into more detailed systems.
It pays to have a contingency plan for your ethical hacking process in case
something goes awry. What if you’re assessing your firewall or Web applica-tion, and you take it down? This can cause system unavailability, which canreduce system performance or employee productivity. Even worse, it couldcause loss of data integrity, loss of data, and bad publicity.
Handle social-engineering and denial-of-service attacks carefully. Determine
how they can affect the systems you’re testing and your entire organization.
Determining when the tests are performed is something that you must think
long and hard about. Do you test during normal business hours? How aboutlate at night or early in the morning so that production systems aren’t affected?Involve others to make sure they approve of your timing.
The best approach is an unlimited attack, wherein any type of test is possi-
ble. The bad guys aren’t hacking your systems within a limited scope, so whyshould you? Some exceptions to this approach are performing DoS, social-engineering, and physical-security tests.
Don’t stop with one security hole. This can lead to a false sense of security.
Keep going to see what else you can discover. I’m not saying to keep hacking16 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 16

until the end of time or until you crash all your systems. Simply pursue the
path you’re going down until you can’t hack it any longer (pun intended).
One of your goals may be to perform the tests without being detected. For
example, you may be performing your tests on remote systems or on a r emote
office, and you don’t want the users to be aware of what you’re doing. Other-wise, the users may be on to you and be on their best behavior.
You don’t need extensive knowledge of the systems you’re testing — just a
basic understanding. This will help you protect the tested systems.
Understanding the systems you’re testing shouldn’t be difficult if you’re hack-
ing your own in-house systems. If you’re hacking a customer’s systems, youmay have to dig deeper. In fact, I’ve never had a customer ask for a fully blindassessment. Most people are scared of these assessments. Base the type oftest you will perform on your organization’s or customer’s needs.
Chapter 19 covers hiring “reformed” hackers.
Selecting tools
As with any project, if you don’t have the right tools for ethical hacking, accom-
plishing the task effectively is difficult. Having said that, just because you use
the right tools doesn’t mean that you will discover all vulnerabilities.
Know the personal and technical limitations. Many security-assessment tools
generate false positives and negatives (incorrectly identifying vulnerabilities).Others may miss vulnerabilities. If you’re performing tests such as social-engineering or physical-security assessments, you may miss weaknesses.
Many tools focus on specific tests, but no one tool can test for everything.
For the same reason that you wouldn’t drive in a nail with a screwdriver, youshouldn’t use a word processor to scan your network for open ports. This iswhy you need a set of specific tools that you can call on for the task at hand.The more tools you have, the easier your ethical hacking efforts are.
Make sure you that you’re using the right tool for the task:
/H12012To crack passwords, you need a cracking tool such as LC4, John the
Ripper, or pwdump.
A general port scanner, such as SuperScan, may not crack passwords.
/H12012For an in-depth analysis of a Web application, a Web-application assess-
ment tool (such as Whisker or WebInspect) is more appropriate than anetwork analyzer (such as Ethereal).17 Chapter 1: Introduction to Ethical Hacking04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 17

Free ebooks ==>   www.Ebook777.com
When selecting the right security tool for the task, ask around. Get advice
from your colleagues and from other people online. A simple Groups searchon Google (
www.google.com ) or perusal of security portals, such as
SecurityFocus.com, SearchSecurity.com, and ITsecurity.com, often producesgreat feedback from other security experts.
Hundreds, if not thousands, of tools can be used for ethical hacking — from
your own words and actions to software-based vulnerability-assessment pro-grams to hardware-based network analyzers. The following list runs downsome of my favorite commercial, freeware, and open-source security tools:
/H12012Nmap
/H12012EtherPeek
/H12012SuperScan
/H12012QualysGuard
/H12012WebInspect
/H12012LC4 (formerly called L0phtcrack)
/H12012LANguard Network Security Scanner
/H12012Network Stumbler
/H12012ToneLoc
Here are some other popular tools:
/H12012Internet Scanner
/H12012Ethereal
/H12012Nessus
/H12012Nikto
/H12012Kismet
/H12012THC-Scan
I discuss these tools and many others in Parts II through V when I go into thespecific hack attacks. Appendix A contains a more comprehensive listing ofthese tools for your reference.
The capabilities of many security and hacking tools are often misunderstood.
This misunderstanding has shed negative light on some excellent tools, suchas SATAN (Security Administrator Tool for Analyzing Networks) and Nmap(Network Mapper).
Some of these tools are complex. Whichever tools you use, familiarize yourself
with them before you start using them. Here are ways to do that:18 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 18
www.Ebook777.com


/H12012Read the readme and/or online help files for your tools.
/H12012Study the user’s guide for your commercial tools.
/H12012Consider formal classroom training from the security-tool vendor or
another third-party training provider, if available.
Look for these characteristics in tools for ethical hacking:
/H12012Adequate documentation.
/H12012Detailed reports on the discovered vulnerabilities, including how theymay be exploited and fixed.
/H12012Updates and support when needed.
/H12012High-level reports that can be presented to managers or nontechie types.
These features can save you time and effort when you’re writing the report.
Executing the plan
Ethical hacking can take persistence. Time and patience are important. Becareful when you’re performing your ethical hacking tests. A hacker in yournetwork or a seemingly benign employee looking over your shoulder maywatch what’s going on. This person could use this information against you.
It’s not practical to make sure that no hackers are on your systems before
you start. Just make sure you keep everything as quiet and private as possi-ble. This is especially critical when transmitting and storing your test results.If possible, encrypt these e-mails and files using Pretty Good Privacy (PGP) orsomething similar. At a minimum, password-protect them.
You’re now on a reconnaissance mission. Harness as much information as
possible about your organization and systems, which is what malicious hack-ers do. Start with a broad view and narrow your focus:
1. Search the Internet for your organization’s name, your computer and
network system names, and your IP addresses.
Google is a great place to start for this.
2. Narrow your scope, targeting the specific systems you’re testing.
Whether physical-security structures or Web applications, a casual
assessment can turn up much information about your systems.
3. Further narrow your focus with a more critical eye. Perform actual
scans and other detailed tests on your systems.
4. Perform the attacks, if that’s what you choose to do.19 Chapter 1: Introduction to Ethical Hacking04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 19

Evaluating results
Assess your results to see what you uncovered, assuming that the vulnerabil-
ities haven’t been made obvious before now. This is where knowledge counts.Evaluating the results and correlating the specific vulnerabilities discoveredis a skill that gets better with experience. You’ll end up knowing your systemsas well as anyone else. This makes the evaluation process much simplermoving forward.
Submit a formal report to upper management or to your customer, outlining
your results. Keep these other parties in the loop to show that your effortsand their money are well spent. Chapter 17 describes this process.
Moving on
When you’ve finished your ethical hacking tests, you still need to implementyour analysis and recommendations to make sure your systems are secure.
New security vulnerabilities continually appear. Information systems con-
stantly change and become more complex. New hacker exploits and securityvulnerabilities are regularly uncovered. You may discover new ones! Securitytests are a snapshot of the security posture of your systems. At any time,everything can change, especially after software upgrades, adding computersystems, or applying patches. Plan to test regularly (for example, once aweek or once a month). Chapter 19 covers managing security changes.20 Part I: Building the Foundation for Ethical Hacking 04 55784x Ch01.qxd  3/29/04  4:16 PM  Page 20

Chapter 2
Cracking the Hacker Mindset
In This Chapter
/H17075Understanding the enemy
/H17075Profiling hackers
/H17075Understanding why hackers do what they do
/H17075Examining how hackers go about their business
Before you start assessing the security of your own systems, it helps to
know something about the enemies you’re up against. Many informa-
tion-security product vendors and other professionals claim that you shouldprotect your systems from the bad guys — both internal and external. Butwhat does this mean? How do you know how these bad guys think and work?
Knowing what hackers want helps you understand how they work. Under-
standing how they work helps you look at your information systems in a whole
new way. In this chapter, I describe what you’re up against, who’s actuallydoing the hacking, and what their motivations and methods are so you’rebetter prepared for your ethical hacking tests.
What You’re Up Against
Thanks to sensationalism, the definition of hacker has transformed from
harmless tinkerer to malicious criminal. Hackers often state that the generalpublic misunderstands them, which is mostly true. It’s easy to prejudge whatyou don’t understand. Hackers can be classified by both their abilities andunderlying motivations. Some are skilled, and their motivations are benign;they’re merely seeking more knowledge. At the other end of the spectrum,hackers with malicious intent seek some form of personal gain. Unfortunately,the negative aspects of hacking usually overshadow the positive aspects,resulting in the stereotyping.
Historically, hackers have hacked for the pursuit of knowledge and the thrill
of the challenge. Script kiddies aside, hackers are adventurous and innovativethinkers, and are always thinking about exploiting computer vulnerabilities.05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 21

(For more on script kiddies, see “Who Hacks,” later in this chapter.) They see
what others often overlook. They wonder what would happen if a cable wereunplugged, a switch were flipped, or lines of code were changed in a program.
These old-school hackers are like Tim the Toolman Taylor — Tim Allen’s char-
acter on the late, great sitcom Home Improvement — thinking mechanical and
electronic devices can be improved if they’re “rewired.” More recent evidenceshows that many hackers are hacking for political, competitive, and even finan-
cial purposes, so times are changing.
When they were growing up, hackers’ rivals were monsters and villains on
video game screens. Now hackers see their electronic foes as only that —electronic. Hackers who perform malicious acts don’t really think about thefact that human beings are behind the firewalls and Web applications they’reattacking. They ignore that their actions often affect those human beings innegative ways, such as jeopardizing their job security.
Hackers and the act of hacking drive the advancement of security technology.
After all, hackers don’t create security holes; they expose and exploit existingholes in applications. Unfortunately, security technology advances don’t wardoff all hacker attacks, because hackers constantly search for new holes andweaknesses. The only sure-fire way to keep the bad guys at bay is to use behav-ior modification to change them into productive, well-adjusted members ofsociety. Good luck with that.
However you view the stereotypical hacker, one thing is certain: Some people
always will try to take down your computer systems through manual hackingor by creating and launching automated worms and other malware. You musttake the appropriate steps to protect your systems against them.
Who Hacks
Computer hackers have been around for decades. Since the Internet becamewidely used in the late 1990s, we’ve started to hear more and more about hack-ing. Only a few hackers, such as John Draper (also known as Captain Crunch)and Kevin Mitnick, are well known. Gobs more unknown hackers are lookingto make a name for themselves. They’re the ones to look out for.
In a world of black and white, it’s easy to describe the typical hacker. A gen-
eral stereotype of a typical hacker is an antisocial, pimple-faced teenage boy.But the world has many shades of gray and, therefore, many types of hackers.Hackers are human like the rest of us and are, therefore, unique individuals,so an exact profile is hard to outline. The best broad description of hackers isthat all hackers aren’t equal. Each hacker has motives, methods, and skills.
But some general characteristics can help you understand them.
Not all hackers are antisocial, pimple-faced teenagers. Regardless, hackers
possess curiosity, bravado, and often very sharp minds.22 Part I: Building the Foundation for Ethical Hacking 05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 22

Free ebooks ==>   www.Ebook777.com
Just like anyone can become a thief, an arsonist, or a robber, anyone can
become a hacker, regardless of age, gender, or race. Given this diverse profile,skills vary widely from one malicious hacker to the next. Some hackers barelyknow how to surf the Internet, whereas others write software that other hack-ers and ethical hackers alike depend on.
/H12012Script kiddies: These are computer novices who take advantage of the
hacker tools and documentation available for free on the Internet butdon’t have any knowledge of what’s going on behind the scenes. Theyknow just enough to cause you headaches but typically are very sloppy intheir actions, leaving all sorts of digital fingerprints behind. Even thoughthese guys are the stereotypical hackers that you hear about in the newsmedia, they often need minimal skills to carry out their attacks.
/H12012Intermediate hackers: These halfway hackers usually know just enough
to cause serious problems. They know about computers and networks,and often use well-known exploits. Some want to be experts; given enoughtime and effort, they can be.
/H12012Elite hackers: These are skilled hacking experts. These are the people
who write many of the hacker tools, including the scripts and other pro-grams that the script kiddies use. These folks write such malware asviruses and worms. They can break into systems and cover their tracks.They can even make it look like someone else hacked the systems.
Elite hackers are often very secretive and share information with their
“subordinates” only when they are deemed worthy. Typically, for lower-ranked hackers to be considered worthy, they must possess some uniqueinformation or prove themselves through a high-profile hack. These hack-ers are your worst enemies in information security. Okay, maybe they’renot as bad as untrained end users, but that’s another issue. Fortunately,elite hackers are not as plentiful as script kiddies.
Other hacktivists try to disseminate political or social messages through theirwork. A hacktivist wants to raise public awareness of an issue. Examples of23 Chapter 2: Cracking the Hacker Mindset
Is the government hacking?
While in a conflict with another country, somegovernments will wage war via the Internet andother computer systems. For example, the U.S.government reportedly has launched cyber-attacks against its adversaries — such asYugoslavia during the Milosevic crisis in the late1990s and in the recent war in Iraq.
Are we headed toward a digital Pearl Harbor?
I’m not convinced that we are, but this methodof waging war is becoming more common astechnology progresses. Many folks are skepti-cal about this as well, and the U.S. govern-ment denies most of its involvement. However,because the world increasingly relies on com-puter and network technology, PCs, and theInternet, those avenues may become the launch-ing pads or battlegrounds for future conflicts.05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 23
www.Ebook777.com


hacktivism are the Web sites that were defaced with the Free Kevin messages
in the name of freeing Kevin Mitnick from prison for his famous hacking
escapades. Other cases of hacktivism include messages about legalizing marijuana, protests against the U.S. Navy spy plane that collided with theChinese fighter jet in 2001, the common hacker attacks between India andPakistan, and attacks against the U.S. White House Web site over the years.
Cyberterrorists attack government computers or public utility infrastructures,
such as power grids and air-traffic-control towers. They crash critical systems
or steal classified government information. Countries take these threats soseriously that many mandate information-security controls in such industriesas the power industry to protect essential systems against these attacks.
Hackers for hire are part of organized crime on the Internet. In late 2003, the
Korean National Police Agency busted the Internet’s largest organized hacking
ring, which had over 4,400 members. Prior to that, police in the Philippinesbusted a multimillion-dollar organized hacking ring that was selling cheapphone calls made through phone lines the ring had hacked into. Many ofthese hackers hire themselves out for money — and lots of it!
Why Hackers Hack
The main reason hackers hack is because they can! Okay, it goes a little deeper
than that. Hacking is a casual hobby for some hackers — they just hack to seewhat they can and can’t break into, usually testing only their own systems.These aren’t the folks I’m writing about here. I’m focusing on those hackerswho are obsessive and often have criminal intent.
Many hackers get a kick out of outsmarting corporate and government IT and
security administrators. They thrive on making headlines and being notoriouscyberoutlaws. Defeating an entity or possessing knowledge makes them feelbetter about themselves. Many of these hackers feed off instant gratification.They become obsessed with this feeling. Hackers can’t resist the adrenalinerush they get when breaking into someone else’s systems. Often, the moredifficult the job is, the greater the thrill.
The knowledge that malicious hackers gain and the elevated ego that comes
with that knowledge are like an addiction and a way of life. Some hackers wantto make your life miserable, and others simply want to be seen or heard. Somecommon hacker motives are revenge, basic bragging rights, curiosity, boredom,
challenge, vandalism, theft for financial gain, sabotage, blackmail, extortion, and
corporate espionage.
Hackers often promote individualism — or at least the decentralization of
information — because many believe that all information should be free.They think cyberattacks are different from attacks in the real world. Theyeasily ignore or misunderstand their victims and the consequences of hacking.24 Part I: Building the Foundation for Ethical Hacking 05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 24

Many hackers say they don’t intend to harm or profit through their bad deeds,
which helps them justify their work. They often don’t look for tangible payoffs.Just proving a point is often a good enough reward for them.
Many business owners and managers — even some network and security
administrators — believe that they don’t have anything that a hacker wants orthat hackers can’t do much damage if they break in. This couldn’t be furtherfrom the truth. This kind of thinking helps support hackers and their objec-tives. Hackers can compromise a seemingly unimportant system to accessthe network and use it as a launching pad for attacks on other systems.
It’s worth repeating that hackers often hack because they can. Some hackers
go for high-profile systems, but hacking into anyone’s system helps them fitinto hacker circles. Hackers use the false sense of security that many peoplehave and go for almost any system they think they can compromise. Theyknow that electronic information can be in more than one place at the sametime. It’s tough to prove that hackers took the information and possess it.
Similarly, hackers know that a simple defaced Web page — however easily
attacked — is not good for business. The following Web sites show examplesof Web pages that have been defaced in the past few years:
/H12012
www.2600.com/hacked_pages
/H12012www.onething.com/archive
Hacked sites like these can persuade management and other nonbelieversthat information threats and vulnerabilities should be addressed.
Hacking continues to get easier for several reasons:
/H12012Increasing use of networks and Internet connectivity
/H12012Anonymity provided by computer systems working over the Internet
/H12012Increasing number and availability of hacking tools
/H12012Computer-savvy children
/H12012Unlikelihood that hackers are investigated or prosecuted if caught
Although most hacker attacks go unnoticed or unreported, hackers who are
discovered are often not pursued or prosecuted. When they’re caught, hack-ers often rationalize their services as being altruistic and a benefit to society:They’re merely pointing out vulnerabilities before someone else does.Regardless, if justice is ever served, it helps eliminate the “fame and glory”reward system that hackers thrive on.
These criminal hackers are in the minority, so don’t think that you’re up
against millions of these villains. Many other hackers just love to tinker andonly seek knowledge of how computer systems work.25 Chapter 2: Cracking the Hacker Mindset05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 25

Planning and Performing Attacks
Hacking styles vary widely:
/H12012Some hackers prepare far in advance of a large attack. They gather
small bits of information and methodically carry out their hacks, as I
outline in Chapter 4. These hackers are more difficult to track.
/H12012Other hackers — usually, the inexperienced script kiddies — actbefore they think things through. For example, such hackers may try to
telnet directly into an organization’s router without hiding their identi-ties. Other hackers may try to launch a DoS attack against a MicrosoftExchange e-mail server without first determining what version ofExchange is running or what patches are installed.
These are the guys who usually get caught.
Although the hacker underground is a community, many of the hackers —
especially the elite hackers — don’t share information with the crowd. Mosthackers do much of their work independently from other hackers. Hackerswho network with one another use private bulletin board systems (BBSs),anonymous e-mail addresses, hacker Web sites, and Internet Relay Chat (IRC).
You can log on to many of these sites to see what hackers are doing.Whatever approach they take, most malicious hackers prey on ignorance.
They know the following aspects of real-world security:
/H12012The majority of systems that hackers want to attack aren’t managedproperly. The computer systems aren’t properly patched, hardened, andmonitored as they should be. Hackers often can attack by flying belowthe average radar of the firewalls, IDSs, and authentication systems.26 Part I: Building the Foundation for Ethical Hacking 
Hacking in the name of liberty
Many hackers exhibit behaviors that contradict
what they’re fighting for — that is, they fight forcivil liberties and want to be left alone, and at thesame time, they love prying into other people’sbusiness. Many hackers claim to be civil liber-tarians supporting the principles of personal pri-vacy and freedom. However, they act in anentirely different way by intruding on the privacyand property of others. They often steal theproperty and rights of others, yet are willing togo to great lengths to get their own rights backfrom anyone who tries to take them away.
The case against copyrighted materials and
the Recording Industry Association of America(RIAA) is a classic example. Hackers have goneto great lengths to prove a point, from defacingthe Web sites of organizations that support copy-rights to illegally sharing music by using other-
wise legal mediums such as Kazaa, Gnutella,and Morpheus.05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 26

/H12012Most network and security administrators simply can’t keep up with the
deluge of new vulnerabilities.
/H12012Information systems grow more complex every year. This is yet anotherreason why overburdened administrators find it difficult to know what’shappening across the wire and on the hard drives of their systems.
Time is a hacker’s friend — and it always seems to be on the hacker’s side. Byattacking through computers rather than in person, hackers have more con-trol over when they can carry out their attacks.
/H12012Hack attacks can be carried out slowly, making them hard to detect.
/H12012They’re frequently carried out after typical business hours — often, inthe middle of the night. Defenses are often weaker at night — with lessphysical security and less intrusion monitoring — when the typical net-work administrator (or security guard) is sleeping.
If you want detailed information on how some hackers work or want to keepup with the latest hacker methods, several magazines are worth checking out:
/H120122600 — The Hacker Quarterly magazine (
www.2600.com ). I’ve found gobs
of great information in 2600.
/H12012PHRACK (www.phrack.org ).
/H12012Computer Underground Digest (www.soci.niu.edu/~cudigest ).
Also, check out Lance Spitzner’s Web site www.tracking-hackers.com for
some great information on using honeypots to track hacker behavior.
Hackers learn from their hacking mistakes. Every mistake moves them one
step closer to breaking into someone’s system. They use this wisdom whencarrying out future attacks.
Maintaining Anonymity
Smart hackers want to be as low-key as possible. Covering their tracks is a
priority. In fact, success often depends on it. They don’t want to raise suspi-cion so they can come back and access the systems in the future. Hackersoften remain anonymous by using one of the following techniques:
/H12012Borrowed or stolen dial-up accounts from friends or previous employers
/H12012Public computers at libraries, schools, or kiosks at the local mall
/H12012Internet proxy servers or anonymizer services
/H12012Anonymous or disposable e-mail accounts from free e-mail services27 Chapter 2: Cracking the Hacker Mindset05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 27

Free ebooks ==>   www.Ebook777.com
/H12012Open e-mail relays
/H12012Unsecured computers — also called zombies — at other organizations
/H12012Workstations or servers on the victim’s own network
If hackers use enough steppingstones for their attacks, they are hard to trace.28 Part I: Building the Foundation for Ethical Hacking 05 55784x Ch02.qxd  3/29/04  4:16 PM  Page 28
www.Ebook777.com


Chapter 3
Developing Your Ethical
Hacking Plan
In This Chapter
/H17075Setting ethical hacking goals
/H17075Selecting which systems to test
/H17075Developing your ethical hacking testing standards
/H17075Examining hacking tools
As an ethical hacker, you must plan your ethical hacking efforts before you
start. A detailed plan doesn’t mean that your testing must be elaborate.
It just means that you’re very clear and concise on what’s done. Given theseriousness of ethical hacking, make this as structured a process as possible.
Even if you’re just testing a single Web application or workgroup of comput-
ers, it’s critical to establish your goals, define and document the scope ofwhat you’ll be testing, determine your testing standards, and gather andfamiliarize yourself with the proper tools for the task. This chapter coversthese steps to help you create a positive ethical hacking environment so youcan set yourself up for success.
Getting Your Plan Approved
Getting approval for ethical hacking is critical. First, obtain project sponsor-ship. This approval can come from your manager, an executive, a customer,or yourself (if you’re the boss). Otherwise, your testing may be canceled sud-denly, or someone can deny authorizing the tests. There can even be legalconsequences for unauthorized hacking. Always make sure that what you’redoing is known and visible — at least to the decision-makers. Chapter 20outlines ten tips for getting upper management’s buy-in on your securityinitiatives.06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 29

If you’re an independent consultant or have a business with a team of ethical
hackers, consider getting professional liability (also known as errors and
omissions ) insurance from an agent who specializes in business insurance
coverage. This kind of insurance can be expensive, but it can be well worth it.
The authorization can be as simple as an internal memo from upper manage-
ment if you’re performing these tests on your own systems. If you’re perform-ing testing for a customer, you must have a signed contract in place, statingthe customer’s support and authorization. Get written approval as soon aspossible to ensure that your time and efforts are not wasted. This documen-tation is your security if anyone questions what you’re doing.
Establishing Your Goals
Your ethical hacking plan needs goals. The main goal of ethical hacking is tofind vulnerabilities in your systems so you can make them more secure. Youcan then take this a step further:
/H12012Define more specific goals. Align these goals with your business
objectives.
/H12012Create a specific schedule with start and end dates. These dates are
critical components of your overall plan.
Before you begin any ethical hacking, you absolutely, positively need every-thing in writing and signed-off on.
Document everything, and involve upper management in this process. Your
best ally in your ethical hacking efforts is a manager who supports whatyou’re doing.
The following questions can start the ball rolling:
/H12012Does ethical hacking support the mission of the business and its IT and
security departments?
/H12012What business goals are met by performing ethical hacking?
These goals may include the following:
• Prepping for the internationally accepted security framework of
ISO 17799 or a security seal such as SysTrust or WebTrust
• Meeting federal regulations• Improving the company’s image
/H12012How will ethical hacking improve security, IT, and the general business?
/H12012What information are you protecting?30 Part I: Building the Foundation for Ethical Hacking 06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 30

This could be intellectual property, confidential customer information,
or private employee information.
/H12012How much money, time, and effort are you and your organization willingto spend on ethical hacking?
/H12012What specific deliverables will there be?
Deliverables can include anything from high-level executive reports to
detailed technical reports and write-ups on what you tested along with
the outcomes of your tests. You can deliver specific information that isgleaned during your testing, such as passwords and other confidentialinformation.
/H12012What specific outcomes do you want?
Desired outcomes include the justification for hiring or outsourcing secu-
rity personnel, increasing your security budget, or enhancing securitysystems.
People within your organization may attempt to keep you from performingyour ethical hacking plans. The best antidote is education. Show how ethicalhacking helps support the business in everyone’s favor.
After you know your goals, document the steps to get there. For example, if
one goal is to develop a competitive advantage to keep existing customersand attract new ones, determine the answers to these questions:
/H12012When will you start your ethical hacking?
/H12012Will your ethical hacking be blind, in which you know nothing about thesystems you’re testing, or a knowledge-based attack, in which you’regiven specific information about the systems you’re testing such as IPaddresses, hostnames, and even usernames and passwords?
/H12012Will this testing be technical in nature or involve physical securityassessments or even social engineering?
/H12012Will you be part of a larger ethical hacking team, often called a tiger team
or red team?
/H12012Will you notify your customers of what you’re doing? If so, how?
Customer notification is a critical issue. Many customers appreciate that
you’re taking steps to protect their information. Approach the testing ina positive way. Don’t say, “We’re breaking into our systems to see whatinformation of yours is vulnerable to hackers.” Instead, you can say thatyou’re assessing the overall security of your systems so the informationis as secure as possible from the bad guys.
/H12012How will you notify customers that the organization is taking steps toenhance the security of their information?
/H12012What measurements can ensure that these efforts are paying off?31 Chapter 3: Developing Your Ethical Hacking Plan06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 31

Establishing your goals takes time, but you won’t regret it. These goals are
your road map. If you have any concerns, refer to these goals to make surethat you stay on track.
Determining What Systems to Hack
You probably don’t want — or need — to assess the security of all your sys-tems at the same time. This could be quite an undertaking and could lead toproblems. I’m not saying you shouldn’t eventually assess every computer andapplication you have. I’m just suggesting that whenever possible, you shouldbreak your ethical hacking projects into smaller chunks to make them moremanageable. You may decide which systems to test based on a high-level riskanalysis, answering questions such as:
/H12012What are your most critical systems? Which systems, if hacked, wouldcause the most trouble or the greatest losses?
/H12012Which systems appear to be most vulnerable to attack?
/H12012Which systems are not documented, are rarely administered, or are theones you know the least about?
After you’ve established your overall goals, decide which systems to test.This step helps you carefully define a scope for your ethical hacking so thatyou not only establish everyone’s expectations up front, but also better esti-mate the time and resources for the job.
The following list includes systems and applications that you may consider
performing your hacking tests on:
/H12012Routers
/H12012Firewalls
/H12012Network infrastructure as a whole
/H12012Wireless access points and bridges
/H12012Web, application, and database servers
/H12012E-mail and file/print servers
/H12012Workstations, laptops, and tablet PCs
/H12012Mobile devices (such as PDAs and cell phones) that store confidentialinformation
/H12012Client and server operating systems
/H12012Client and server applications, such as e-mail or other in-house systems32 Part I: Building the Foundation for Ethical Hacking 06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 32

What specific systems you should test depends on several factors. If you have
a small network, you can test everything from the get-go. You may considertesting just public-facing hosts such as e-mail and Web servers and theirassociated applications. The ethical hacking process is flexible. Base thesedecisions on what makes the most business sense.
Start with the most vulnerable systems, and consider the following factors:
/H12012Where the computer or application resides on the network
/H12012Which operating system and application(s) it runs
/H12012The amount or type of critical information stored on it
If you’re hacking your own systems or a customer’s systems, a previous
security-risk assessment or vulnerability test may already have generatedthis information. If so, that documentation may help identify systems formore testing.
Ethical hacking goes a few steps beyond the higher-level information risk
assessments and vulnerability testing. As an ethical hacker, you first gleaninformation on all systems — including the organization as a whole — andthen further assess the systems that appear most vulnerable. I discuss theethical hacking methodology in more detail in Chapter 4.
Another factor to help you decide where to start is to assess the systems that
have the greatest visibility. For example, focusing on a database or file serverthat stores customer or other critical information may make more sense — atleast initially — than concentrating on a firewall or Web server that hostsmarketing information about the company.
Creating Testing Standards
One miscommunication or slip-up can send your systems crashing duringyour ethical hacking tests. No one wants that to happen. To prevent mishaps,develop and document testing standards. These standards should include
/H12012When the tests are performed, along with the overall timeline
/H12012What tests are performed
/H12012How the tests are performed, and from where
/H12012How much knowledge of the systems you acquire in advance
/H12012What you do when a major vulnerability is discovered
This is a list of general best practices. You can apply more standards for yoursituation.33 Chapter 3: Developing Your Ethical Hacking Plan06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 33

Timing
You know they say that it’s “all in the timing.” This is especially true when
performing ethical hacking tests. Make sure that the tests you’re performingminimize disruption to business processes, information systems, and people.You want to avoid situations like miscommunicating the timing of tests andcausing a DoS attack against a high-traffic e-commerce site in the middle ofthe day, or forcing yourself or others to perform password-cracking tests inthe middle of the night. It’s amazing what a 12-hour time difference can make!Everyone in the project should agree on a detailed timeline before you begin.This puts everyone on the same page and sets correct expectations.
Notify any Internet Service Providers (ISP) or Application Service Providers
(ASPs) involved before performing any tests across the Internet. This way,ISPs and ASPs will be aware of the testing going on, which will minimize thechance that they will block your traffic if they suspect malicious behaviorthat shows up on their firewalls or Intrusion Detection Systems (IDSs).
The timeline should include specific short-term dates and times of each test,
the start and end dates, and any specific milestones in between. You candevelop and enter your timeline into a simple spreadsheet or Gantt chart, oryou can include the timeline as part of your initial customer proposal andcontract. For example, you could use a timeline similar to the following:
Test Performed Tester Start Time Projected End Time
War dial Tommy Tinker July 1, 6:00 a.m. July 1, 10:00 a.m.
Password cracking Amy Trusty July 2, 12:00 p.m. July 2, 5:00 p.m.
This timeline will keep things simple and provide a reference during testing.
Specific tests
You may have been charged with performing a general penetration test , or you
may want to perform specific tests, such as cracking passwords or war-dialinginto a network. Or you might be performing a social-engineering test or assess-ing the Windows operating systems on the network. However you’re testing,you may want to conceal the specifics of the testing to keep what you’re doingcovert or to protect your methodologies. In fact, your manager or customermay not want the details. Either way, document and make known at a high levelwhat you’re doing. This can help eliminate any potential miscommunicationand keep you out of hot water.
A good way to provide evidence of what was tested, when it was tested, and
more is to enable logging on the systems you’re testing.34 Part I: Building the Foundation for Ethical Hacking 06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 34

Sometimes, you may know the general tests that you’re performing, but if you’re
using automated tools, it may be next to impossible to understand completelyevery test you’re performing. This is especially true if the software you’re usingreceives real-time vulnerability-testing updates from the vendor every time yourun it. The potential for frequent updates underscores the importance of read-ing the documentation and readme files that come with the tools you’re using.
I have experienced surprising vulnerability updates in the past. I was perform-
ing an automated assessment on a customer’s Web site — the same test I hadjust performed the previous week. The customer and I had scheduled the testdate and time in advance. What I didn’t know is that the software vendor made
some changes to its Web form submission tests, and I flooded the customer’sWeb application, creating a DoS condition.
Luckily, this DoS condition occurred after business hours and didn’t affect
the customer’s operations. However, the customer’s Web application wascoded to generate an alert e-mail for every form submission. The applicationdeveloper and company’s president received 4,000 e-mails in their inboxeswithin about 10 minutes — ouch! I was lucky that the president was tech-savvy and understood the situation. It’s important to have a contingency planin case a situation like this occurs.
Blind versus knowledge assessments
It may be good to have some knowledge of the systems you’re testing, but it’snot required. However, a basic understanding of the systems you’re hackingcan protect you and others. Obtaining this knowledge shouldn’t be difficult ifyou’re hacking your own in-house systems. If you’re hacking a customer’ssystems, you may have to dig a little deeper into how the systems work soyou know what’s what. That’s how I’ve always done it. In fact, I’ve never hada customer ask for a fully blind assessment. Most people are scared of theseassessments. This doesn’t mean that blind assessments aren’t valuable. Thetype of assessment you carry out depends on your specific needs.
The best approach is to plan on unlimited attacks, wherein any test is possible.
The bad guys aren’t hacking your systems within a limited scope, so why
should you?
Consider whether the tests should be undetected. This isn’t required but
should be considered, especially for social-engineering and physical securitytests. I outline specific tests for those subjects in Chapter 5 and Chapter 6.
A false sense of vigilance can be created if too many insiders know about your
testing which can end up negating the hard work you’re putting into this.This doesn’t mean you shouldn’t tell anyone. Always have a main point ofcontact within the organization — preferably someone with decision-makingauthority — that both you and all employees can contact if and when some-thing goes wrong.35 Chapter 3: Developing Your Ethical Hacking Plan06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 35

Location
The tests you’re performing dictate where you must run them from. Your goal
is to hack your systems from locations where malicious hackers can accessthe systems. You can’t predict whether you’ll be attacked by a hacker fromoutside or inside your network, so cover all your bases. Combine external(public Internet) tests and internal (private network) tests.
You can perform some tests, such as password cracking and network-infra-
structure assessments, from the comfort of your office — inside the network.But it may be better to have a true outsider perform other tests on routers,firewalls, and public Web applications.
For your external hacks that require network connectivity, you may have to
go off-site (a good excuse to work from home) or use an external proxy server.Better yet, if you can assign an available public IP address to your computer,plug into the network on the outside of the firewall for a hacker’s-eye view ofyour systems. Internal tests are easy because you need only physical accessto the building and the network.
Reacting to major exploits that you find
Determine ahead of time whether you’ll stop or keep going when you find acritical security hole. Your manager or your customer may not ask you to,but I think it’s best to keep going to see what else you can discover. I’m notsaying to keep hacking until the end of time or until you crash all your sys-tems. Simply pursue the path you’re going down until you can’t hack it anylonger (pun intended).
Silly assumptions
You’ve heard what you make of yourself when you assume things. Even so,you must make assumptions when you hack your systems. Here are someexamples of those assumptions:
/H12012Computers, networks, and people are available when you’re testing.
/H12012You have all the proper hacking tools.
/H12012The hacking tools you’re using won’t crash your systems.
/H12012Your hacking tools actually work.
/H12012You know all the risks of your tests.
You should document all assumptions and have management or your cus-tomer sign off on them as part of your overall approval process.36 Part I: Building the Foundation for Ethical Hacking 06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 36

Selecting Tools
The required security-assessment tools (hacking tools) depend on the tests
you’re running. You can perform some ethical hacking tests with a pair of
sneakers, a telephone, and a basic workstation on the network. However,comprehensive testing is easier with hacking tools.
Not only do you need an arsenal of tools, but you should also use the right
tool for the task:
/H12012If you’re cracking passwords, a general port scanner such as SuperScanor Nmap may not do the trick. For this task, you need a tool such as LC4,John the Ripper, or pwdump.
/H12012If you’re attempting an in-depth analysis of a Web application, a Web-application assessment tool (such as Nikto or WebInspect) is moreappropriate than a network analyzer such as Ethereal.
If you’re not sure what tools to use, fear not. Throughout this book, I intro-duce a wide variety of tools — both free and commercial — that you can useto accomplish your tasks.
You can choose among hundreds, if not thousands, of tools for ethical
hacking — everything from your own words and actions to software-basedvulnerability-assessment programs to hardware-based network analyzers.Here’s a rundown of some of my favorite commercial, freeware, and open-source security tools:
/H12012@stake L0phtcrack (now called LC4)
/H12012Ethereal
/H12012Foundstone SuperScan
/H12012Qualys QualysGuard
/H12012GFI LANguard Network Security Scanner
/H12012John the Ripper
/H12012Network Stumbler
/H12012Nessus
/H12012Nikto
/H12012Nmap
/H12012Pwdump2
/H12012SPI Dynamics WebInspect
/H12012THC-RUT
/H12012ToneLoc37 Chapter 3: Developing Your Ethical Hacking Plan06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 37

Free ebooks ==>   www.Ebook777.com
/H12012Wellenreiter
/H12012WildPackets EtherPeek and AiroPeek
I discuss these tools, including details on how to use many of them, in Parts II
through V when I cover specific hack attacks. Appendix A contains a morecomprehensive listing of these tools for your reference.
The capabilities of many security and hacking tools are often misunderstood.
This misunderstanding has shed negative light on some excellent tools, suchas SATAN (Security Administrator Tool for Analyzing Networks) and Nmap(Network Mapper). It’s important to know what each tool can and can’t doand how to use each one. I suggest reading the manual and other help files.Unfortunately, some tools have limited documentation, which can be prettyfrustrating when you’re trying to use those tools. You can search newsgroupsand message boards and post a message if you’re having trouble with a tool.
Hacking tools can be hazardous to your network’s health. Be careful when
using them. Always make sure that you understand what every option doesbefore you use it. Try your tools on test systems if you’re not sure how to usethem. These precautions help prevent DoS conditions and loss of dataintegrity and availability on your production systems.
Look for these characteristics in the tools you select for ethical hacking:
/H12012Adequate documentation.
/H12012Detailed reports on the vulnerabilities, including how they may be
exploited and fixed.
/H12012Updates and support when needed.
/H12012High-level reports that can be presented to managers or other nontechietypes. These reports can save you time and effort when you’re writingthe report. I cover the reporting process in Chapter 17.
Know the limitations of your tools and of yourself. Many security-assessmenttools generate false positives — alerting to a vulnerability when it doesn’treally exist. Some even generate false negatives, which means they miss thevulnerabilities altogether. Likewise, if you’re performing social-engineeringtests or physical-security assessments, it’s only human to miss specificvulnerabilities.
You may despise some “popular” freeware and open-source hacking tools. If
these tools end up causing you more headaches than they’re worth or don’tdo what you need them to do, consider purchasing commercial alternatives.They’re often easier to use and typically generate better reports faster —especially high-level executive reports. Some commercial tools are quiteexpensive, but their ease of use and functionality may justify the cost.38 Part I: Building the Foundation for Ethical Hacking 06 55784x Ch03.qxd  3/29/04  4:16 PM  Page 38
www.Ebook777.com


Chapter 4
Hacking Methodology
In This Chapter
/H17075Examining steps for successful ethical hacking
/H17075Gleaning information about your organization from the Internet
/H17075Scanning your network
/H17075Looking for vulnerabilities
Before you start testing your systems, plan a basic methodology. Ethical
hacking involves more than just penetrating and patching. Proven tech-
niques can help guide you along the hacking highway and ensure that youend up at the right destination. Planning a methodology that supports yourethical hacking goals is what separates the professionals from the amateurs.
Setting the Stage
In the past, ethical hacking was mostly a manual process. Now, tools canautomate various tasks. These tools allow you to focus on performing thetests instead of on your testing methods. However, it’s important to follow ageneral methodology and understand what’s going on behind the scenes.
Ethical hacking is similar to beta testing software. Think logically — like a
programmer — dissecting and interacting with all the network componentsto see how they work. You gather information — often small pieces — andassemble the pieces of the puzzle. You start at point A with several goals inmind, hack (repeating many steps along the way), and move closer until youdiscover security vulnerabilities at point B.
The process that ethical hacking is built around is basically the same as what
a malicious hacker would use. The goals and how you achieve them are dif-ferent. In addition, as an ethical hacker, you will eventually attempt to assessallinformation-security vulnerabilities and properly address them, rather
than run a single exploit. Today’s attacks can come from any angle againstany system, not just from the perimeter of your network and the Internet.Test every possible entry point, including partner, vendor, and customer
networks, as well as home users, wireless LANs, and modems.07 55784x Ch04.qxd  3/29/04  4:15 PM  Page 39

Free ebooks ==>   www.Ebook777.com
When you start rolling with your ethical hacking, keep detailed logs of every
test you perform, every system you test, and your results. This informationcan help you do the following:
/H12012Track what worked in previous tests and why.
/H12012Help prove that you didn’t maliciously hack the systems.
/H12012Correlate your testing with intrusion-detection systems and other logfiles if questions arise.
In addition to taking general notes, it’s also helpful to take screen captures ofyour results whenever possible. These will come in handy later if you need toshow proof of what occurred, as well as when you’re generating your finalreport. Chapter 1 lists the general steps of ethical hacking.
These steps don’t include specific information on the low-tech hacking methods
that you will use for social engineering and assessing physical security, butthe techniques are basically the same. I cover these methods in more detailin Chapters 5 and 6.
Your main task is to simulate information-gathering and system compromises
carried out by a hacker. This can be either a partial attack on one computeror a comprehensive attack against the entire organization. Generally, you’relooking for what both inside and outside hackers see. You want to assessinternal systems (processes and procedures that involve computers, net-works, people, and physical infrastructures). Look for vulnerabilities; checkhow all your systems interconnect and how private systems and informationare protected from untrusted elements.
If you’re performing ethical hacking for a customer, you may go the blind-
assessment route and start with just the company name and no other infor-mation that gives you a leg up, such as:
/H12012IP addresses
/H12012Host names
/H12012Software versions
/H12012Firewall rules
/H12012Phone numbers
/H12012Employee names
This blind-assessment approach allows you to start from ground zero andgives you a better sense of what information hackers can access publicly.
As an ethical hacker, you may not have to worry about covering your tracks
or evading intrusion-detection systems, because everything you’re doing islegitimate. But then again, one of your goals may be to test systems in a stealthy40 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:15 PM  Page 40
www.Ebook777.com


fashion. I discuss techniques that hackers use to conceal their actions in later
chapters and outline some countermeasures for them as well. I don’t discusscovering your tracks in the overall ethical hacking methodology.
Seeing What Others See
Your reconnaissance mission can turn up a ton of information about yourorganization and systems that the whole world can see. This process is oftencalled footprinting. Here’s how to gather the information:
/H12012Start by using a Web browser to search the Web for information aboutyour organization.
With the resources available on the Internet, you can gather information
until the end of time. Unless you’re really bored or trying to take advan-
tage of AOL’s introductory offer to stay online for free for 23 hours a day,I don’t recommend it!
/H12012Discover more-specific information about your systems from a hacker’sviewpoint. You can determine this information by running network scans,probing ports, and assessing vulnerability.
Whether you’re searching generally or probing more technically, you ulti-mately should limit the amount of information you gather based on what’sreasonable for you. You may spend an hour, a day, or a week gathering thisinformation — it all just depends on how large your organization is and thecomplexity of your information systems.
Gathering public information
The amount of information you can passively gather usually is staggering.This information is all over the Internet. It’s your job to find out what every-one knows about you. This information positions hackers to target specificareas, including departments and individuals.
Web search
Performing a Web search or simply browsing your Web site can turn up thefollowing information:
/H12012Employee names and contact info
/H12012Important company dates
/H12012Incorporation filings for private companies41 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:15 PM  Page 41

/H12012SEC filings for public companies
/H12012Press releases on moves, organizational changes, and new products
/H12012Mergers and acquisitions
/H12012Patents and trademarks
/H12012Presentations, articles, and Webcasts
My favorite tool — the favorite of many hackers — is Google ( www.google.
com). It ferrets out information — from word-processing documents to graph-
ics files — on any publicly accessible computer. It’s free, too! There are entire
books on using Google. Appendix A lists my favorite resources. With Google,you can search the Internet several ways:
/H12012By typing keywords: This often reveals dozens and sometimes hun-
dreds of pages of information — such as files, phone numbers, andaddresses — that you never guessed were available.
/H12012By performing more advanced Web searches: Google’s advanced search
options can find sites that link back to your company’s Web site. Thistype of search often reveals a lot of information about partners, vendors,clients, and other affiliations.
/H12012By using switches to dig deeper into a Web site: For example, if you
want to find a certain word or file on your Web site, simply enter a linelike one of the following into Google:
site:www.your_domain.com keyword
site:www.your_domain.com filename
Web crawling
Web-crawling utilities such as BlackWidow can mirror your Web site by down-loading every publicly accessible file from it. You can then inspect
/H12012The Web site layout and configuration offline.
/H12012The HTML source code of Web pages.
/H12012Comment fields. These fields contain such information as names ande-mail addresses of the developers and internal IT personnel, servernames, software versions, and internal addressing schemes.
Web sites
These Web sites may provide specific information about your organization: 
/H12012Government and business Web sites:
•www.hoovers.com and finance.yahoo.com for detailed informa-
tion about public companies42 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:15 PM  Page 42

•www.sec.gov/edgar.shtml for SEC filings on public companies
•www.uspto.gov for patent and trademark registrations
• The Web site for your state’s Secretary of State or similar organiza-
tion for incorporation and corporate officer information
/H12012Background checks through companies such as ChoicePoint
(www.choicepoint.com ) and USSearch ( www.ussearch.com )
Mapping the network
When you’re mapping out your network, you can search public databasesand resources to see what the hackers know about you.
Whois
The best starting point is to perform a Whois lookup by using any one of theWhois tools available on the Internet. Whois is the tool you’ve most likely
used to check whether a particular Internet domain name is available.
For ethical hacking, Whois provides information that can give a hacker a leg
up to start a social-engineering attack or to scan your network:
/H12012Internet domain-name information, such as contact names and addresses
/H12012DNS servers responsible for your domain
You can look up Whois information at one of the following places:
/H12012A domain registrar’s site, such as 
www.networksolutions.com or
www.registerfly.com .
/H12012An ISP’s tech-support page.
My favorite Whois tool is Sam Spade ( www.samspade.org ). You can use its
Web site or download its Windows-based tool, shown in Figure 4-1.
You can run DNS queries directly from the site or download the site’s Windows-
based tool and run it from your PC. Sam Spade can 
/H12012Display general domain-registration information
/H12012Show which host handles e-mail (the Mail Exchanger or MX record) for adomain
/H12012Determine whether the host is listed on some spam blacklists43 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:15 PM  Page 43

The following list runs down various lookup sites for other categories:
/H12012Government: whois.nic.gov
/H12012Military: whois.nic.mil
/H12012AfriNIC: www.afrinic.org (emerging Regional Internet Registry for
Africa)
/H12012APNIC: www.apnic.net/search/index.html (Regional Internet
Registry for the Asia Pacific Region)
/H12012ARIN: www.arin.net/whois/index.html (Regional Internet Registry
for North America, a portion of the Caribbean, and subequatorial Africa)
/H12012LACNIC: Latin American and Caribbean Internet Addresses Registry
www.lacnic.net
/H12012RIPE Network Coordination Centre: www.ripe.net/db/whois/
whois.html (Europe, Central Asia, African countries north of the
equator, and the Middle East)
Alldomains.com offers a reverse Whois service called D-Tective. This paid
service finds specific Internet domains for a domain name, a phone number,
or an address.
Figure 4-1:
The Sam
Spade
graphical
interface.44 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 44

Google groups
The Google Groups at groups.google.com can reveal surprising public
network information. Search for such information as your hostnames, IP
addresses, and usernames. You can search hundreds of millions of Usenetposts back to 1981 for public and often very private information.
You might find some information such as the following that you didn’t realize
was being made public:
/H12012A tech-support or similar message that divulges too much informationabout your systems. Many people who post messages to Usenet don’trealize that their messages are shared with the world.
/H12012Disgruntled employees or customers who have posted confidential infor-mation about your company.
A few years ago, I was helping some folks at an Internet startup companyselect a telephone service vendor. I searched Google Groups for a vendorthey were interested in and turned up some interesting information aboutthe telephone service’s network. Apparently, its network administrator hadposted some messages to a tech-support site that revealed his full name ande-mail address, specific server names, IP addresses, and network configura-tion information of its internal systems. My customer used another vendor.
If you discover that confidential information is posted about your company,
you may be able to get it removed. Check out the Google Groups help page at
groups.google.com/googlegroups/help.html for details.
Privacy policies
Check your Web site’s privacy policy. A good practice is to disclose basicinformation about how user information is protected. 
Make sure that the people writing privacy policies don’t divulge details about
your information-security infrastructure. An Internet startup businessmanonce contacted me about business opportunities. During the conversation,he was bragging about his company’s security systems to ensure the privacyof client information. I went to his Web site to check out his privacy policy.He had posted the brand and model of firewall he was using. Not a good idea!
Scanning Systems
Active information gathering produces more details about your network andhelps you see your systems from a hacker’s perspective. For instance, you can45 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 45

/H12012Use the information provided by your Whois lookups and start testing
other closely related IP addresses and host names. When you map out —enumerate — your network, you see how your systems are laid out. 
This includes determining IP addresses, host names (both external and internal), running protocols, open ports, and running servicesand applications.
/H12012Scan your internal hosts — if they are within the scope of your testing.These hosts may not be visible to outsiders, but you should test them.The hacker may be on the inside!
If you’re not completely comfortable scanning your systems, consider firstusing a lab with test systems or a system running virtual-machine softwaresuch as VMware Workstation or Microsoft’s Virtual PC. Some hacking toolsmay not work as designed when you run them on virtual-machine software. Ifyou have trouble getting the software to load or hosts to respond, you mayhave to run your tests against physically separate computers.
Hosts
Scan and document specific hosts that are reachable from the Internet. Startby pinging either specific host names or IP addresses with one of these:
/H12012The basic ping utility that’s built into your operating system
/H12012A third-party utility that allows you to ping multiple addresses at thesame time, such as SuperScan (
www.foundstone.com ) and NetScanTools
Pro (www.netscantools.com ) for Windows and fping for UNIX (which
allows you to ping more than one address)
The site www.whatismyip.com shows how your gateway IP address appears
on the Internet. Just browse to that site. Your outermost public IP address(your firewall or router — preferably not your local computer) appears.
Modems and open ports
Scan for modems and open ports by using network-scanning tools:
/H12012Check for unsecured modems with war-dialing software, such as ToneLoc,PhoneSweep, and THC-Scan. I cover war dialing in Chapter 8.
/H12012Scan network ports with SuperScan or Nmap (
www.insecure.org/
nmap ). You can use a happy-clicky-GUI version made for Windows called
NMapWin, shown in Figure 4-2. See Chapter 9 for details.
/H12012Listen to network traffic with a network analyzer such as Ethereal. I coverthis topic in various chapters throughout the book.46 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 46

Scanning internally is easy. Simply connect your PC to the network, load up
the software, and fire away. Scanning from outside your network takes a few
more steps, but it can be done:
/H12012For war dialing, scanning shouldn’t be an issue. You can just use one of
your internal analog lines to dial out from.
/H12012Pinging and scanning is more complicated. The easiest way to connectand get an “outside-in” perspective is to assign yourself a public IPaddress and plug your workstation into a switch or hub on the publicside of your firewall or router. Physically, you’re not on the Internet look-ing in, but this type of connection works just the same.
Determining What’s Running
on Open Ports
As an ethical hacker, you should glean as much information as possible after
scanning your systems. You can often identify the following information:
/H12012Protocols in use, such as IP, IPX, and NetBEUI
/H12012Services running on the hosts, such as e-mail and database applications
Figure 4-2:
The
NMapWin
graphical
interface.47 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 47

Free ebooks ==>   www.Ebook777.com
/H12012Available remote-access services, such as Windows Terminal Services
and Secure Shell (SSH)
/H12012VPN services, such as PPTP, SSL, and IPSec
/H12012Required authentication for network shares
You can look for the following open ports (your network scanning programreports these as open):
/H12012Ping (ICMP echo) replies; ICMP traffic is allowed to and from the host
/H12012TCP port 20 and/or 21, showing that FTP is running
/H12012TCP port 23, showing that telnet is running
/H12012TCP ports 25 or 465 (SMTP), 110 or 995 (POP3), or 143 or 993 (IMAP),showing that an e-mail server is running
/H12012TCP/UDP port 53, showing that a DNS server is running
/H12012TCP ports 80 and 443, showing that a Web server is running
/H12012TCP/UDP ports 137, 138, and 139, showing that an unprotected Windowshost is running
Thousands of ports can be open — 65,535, to be exact. I cover many popularport numbers when describing hacks throughout this book. A listing of allwell-known port numbers (ports 1–1023) and registered port numbers (ports1024–49151), with their associated protocols and services, is located at
www.iana.org/assignments/port-numbers . You can also perform a port-
number lookup at www.cotse.com/cgi-bin/port.cgi .
If you detect a Web server running on the system you’re testing, you cancheck the software version by using one of the following methods:
/H12012Type the site’s name, followed by a page that you know doesn’t exist,such as 
www.your_domain.com/1234.html . Many Web servers return
an error page showing detailed version information.
/H12012Use Netcraft’s Web server-search utility ( www.netcraft.com ), which
connects to your server from the Internet and displays the Web-serverversion and operating system, as shown in Figure 4-3.
You can dig deeper for more specific information on your hosts. This revealswhat software version is running on the systems and more:
/H12012NMapWin can determine the system OS version; refer to Figure 4-2.
/H12012An enumeration utility (such as DumpSec) can extract users, groups,and file and share permissions directly from Windows.
/H12012Many systems return useful banner information when you connect to aservice or application running on a port. For example, if you telnet to an48 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 48
www.Ebook777.com


e-mail server on port 25 by entering telnet mail.your_domain.com
25at a command prompt, you may see something like this:
220 mail.your_domain.com ESMTP all_the_version_info_
you’ll_ever_need Ready
Most e-mail servers return detailed information, such as the version and
the current service pack installed. After you have this information, you(and hackers) can determine what vulnerabilities are present on thesystem from some of the Web sites listed in the next section.
/H12012An e-mail to an invalid address may return with detailed e-mail headerinformation. A bounced message often discloses lots of information thatcan be used against you, including internal IP addresses and softwareversions. On certain Windows systems, you can map drives and establishother types of network connections. I cover these issues in Chapter 11.
Assessing Vulnerabilities
After finding potential security holes, test whether they are vulnerabilities.Before you test, perform some manual searching. You can research hackermessage boards, Web sites, and vulnerability databases, such as these:
/H12012Common Vulnerabilities and Exposures (
cve.mitre.org/cve )
/H12012CERT/CC Vulnerability Notes Database ( www.kb.cert.org/vuls )
/H12012NIST ICAT Metabase ( icat.nist.gov/icat.cfm )
These sites list practically every known vulnerability. If you can’t find a vulner-ability documented on one of these sites, search the vendor’s site. You can find
Figure 4-3:
Netcraft’s
Web-server
version
utility.49 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 49

a list of commonly exploited vulnerabilities at www.sans.org/top20 . This is
the SANS Top 20 Internet Security Vulnerabilities consensus list, which is
compiled and updated by information-security authorities.
If you’re not keen on researching your potential vulnerabilities and can jump
right into testing, you have a couple of options:
/H12012Manual assessment: You can assess the potential vulnerabilities by con-
necting to the ports that are exposing the service or application andpoking around. You should manually assess certain vulnerabilities (suchas in Web applications). The vulnerability reports in the preceding data-bases often disclose how to do this — at least generally. If you have a lotof free time, performing these tests manually may be for you.
/H12012Automated assessment: If you’re like me, you’ll assess vulnerabilities
automatically when you can. Manual assessments are a great way tolearn, but people usually don’t have the time for most manual steps.
I love many of the available vulnerability-assessment tools. Some test for vulnerabilities on specific platforms (such as Windows and UNIX) andtypes of networks (either wired or wireless). They test for specific systemvulnerabilities — some even focus on the SANS Top 20 list. Versions of thesetools can map the business logic within an application; others can help soft-ware developers test for code flaws. The drawback to these tools is that theyfind only individual vulnerabilities, not correlating vulnerabilities. However,this is changing with the advent of event-correlation applications.
Many people love the Nessus tool (
www.nessus.org ). However, it’s not best
for beginners or without a Linux or UNIX server.One of my favorite ethical hacking weapons is a vulnerability-assessment tool
called QualysGuard by Qualys (
www.qualys.com ). It’s both a port scanner
and vulnerability-assessment tool. You don’t even need a computer to run it.
QualysGuard — which has its roots in Nessus — is an application service
provider-based commercial tool. Just browse to the Qualys Web site, log in,and enter the IP address of the systems you want to test. You schedule theassessment; it runs, then generates excellent reports, such as these:
/H12012An executive report containing information like the partial screencapture of a QualysGuard report shown in Figure 4-4.
/H12012A technical report of detailed explanations of the vulnerabilities andspecific countermeasures.
Like most good security tools, you pay for QualysGuard — it’s not the leastexpensive tool — but you get what you pay for. Some newer products offersimilar technical capabilities while adding convenience.50 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 50

Free ebooks ==>   www.Ebook777.com
Assessing vulnerabilities with a tool such as QualysGuard requires follow-up
expertise. Study the reports to base your recommendations on the testedsystems. 
Penetrating the System
You can use identified critical security holes to do the following:
/H12012Gain further information about the host and its data.
/H12012Start or stop certain services or applications.
/H12012Access other systems.
/H12012Disable logging or other security controls.
/H12012Capture screen shots.
/H12012Install such hacker tools as rootkits (hacker programs that masquerade
as legitimate OS programs) and network analyzers for later backdoorentry.
/H12012Capture keystrokes.
/H12012Send an e-mail as the administrator.
/H12012Perform a buffer-overflow attack.
/H12012Launch another type of DoS attack.
/H12012Upload a file proving your victory.
Figure 4-4:
A sample
QualysGuard
vulnera bility-
assessment
report.51 Chapter 4: Hacking Methodology07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 51
www.Ebook777.com


You can exploit the vulnerabilities on your systems and go for complete
system penetration. Ideally, you’ve already made your decision on this. Youmay want to leave well enough alone. There are also tasks you can’t do —such as installing rootkits or planting a file — unless you try.
Leave the more-intrusive penetration to those with more time on their hands.
Focus on correcting problems. Part VI of this book covers reporting, patching,and managing.
Don’t take the steps I outline in this chapter too literally. General ethical
hacking methodologies can be either too simplistic or too rigid. Ultimately,you are in control and can decide what to do and when to do it.52 Part I: Building the Foundation for Ethical Hacking 07 55784x Ch04.qxd  3/29/04  4:16 PM  Page 52

Part II
Putting Ethical
Hacking in Motion08 55784X PP02.qxd  3/29/04  4:15 PM  Page 53

In this part . . .
Let the games begin! You’ve waited long enough —
now’s the time to start testing your systems. But
where do you start? How about with your two Ps — your
people and your physical systems? These are, after all,two of the most easily and commonly attacked targets inyour organization.
This part starts out with a discussion of hacking people.
It then goes on to take a look at physical security vulnera-bilities. Of course, I’d be remiss in a part about people if Iskipped passwords, so I cover testing those as well. Thisis a great way to get the ball rolling to warm you up for themore speciﬁc hacks that come later in the book.08 55784X PP02.qxd  3/29/04  4:15 PM  Page 54

Chapter 5
Social Engineering
In This Chapter
/H17075Introducing social engineering
/H17075Examining the ramifications of social engineering
/H17075Understanding social-engineering techniques
/H17075Protecting your organization against social engineering
Social engineering takes advantage of the weakest link in any organiza-
tion’s information-security defenses: the employees. Social engineering is
“people hacking” and involves maliciously exploiting the trusting nature of
human beings for information that can be used for personal gain.
Social Engineering 101
Typically, hackers pose as someone else to gain information they otherwisecan’t access. Hackers then take the information obtained from their victimsand wreak havoc on network resources, steal or delete files, and even commitindustrial espionage or some other form of fraud against the organizationthey’re attacking. Social engineering is different from physical-security issues,
such as shoulder surfing and dumpster diving, but they are related.
Here are some examples of social engineering:
/H12012False support personnel claim that they need to install a patch or new
version of software on a user’s computer, talk the user into downloading
the software, and obtain remote control of the system.
/H12012False vendors claim to need to make updates to the organization’s
accounting package or phone system, ask for the administrator pass-word, and obtain full access.
/H12012False contest Web sites run by hackers gather user IDs and passwords
of unsuspecting contestants. The hackers then try those passwords onother Web sites, such as Yahoo! and Amazon.com, and steal personal orcorporate information.09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 55

/H12012False employees notify the security desk that they have lost their keys
to the computer room, are given a set of keys, and obtain unauthorized
access to physical and electronic information.
Sometimes, social engineers act as forceful and knowledgeable employees,such as managers or executives. Other times, they may play the roles ofextremely uninformed or naïve employees. They often switch from one modeto the other, depending on whom they are speaking to.
Effective information security — especially for fighting social engineering —
begins and ends with your users. Other chapters in this book provide greattechnical advice, but never forget that basic human communication andinteraction also affect the level of security. The candy-security adage is “Hard
crunchy outside, soft chewy inside.” The hard crunchy outside is the layer of
mechanisms — such as firewalls, intrusion-detection systems, and encryp-tion — that organizations rely on to secure their information. The soft chewy
inside is the people and the systems inside the organization. If hackers can
get past the thick outer layer, they can compromise the (mostly) defenselessinner layer.
Social engineering is one of the toughest hacks, because it takes great skill to
come across as trustworthy to a stranger. It’s also by far the toughest hackto protect against because people are involved. In this chapter, I explore theramifications of social engineering, techniques for your own ethical hackingefforts, and specific countermeasures to take against social engineering.
Before You Start
I approach the ethical hacking methodologies in this chapter differently thanin subsequent hacking chapters. Social engineering is an art and a science. Ittakes great skill to perform social engineering as an ethical hacker and isdependent upon your personality and overall knowledge of the organizationyou’re testing. If social engineering isn’t natural for you, consider using theinformation in this chapter for educational purposes — at first — until youhave more time to study the subject.
You can use the information in this chapter to perform specific tests or improve
information-security awareness in your organization. Social engineering canharm people’s jobs and reputations, and confidential information could beleaked. Proceed with caution and think before you act.
You can perform social-engineering attacks millions of ways. For this reason,
and because it’s next to impossible to train specific behaviors in one chapter,I don’t provide how-to instructions on carrying out social-engineering attacks.
Instead, I describe specific social-engineering scenarios that have worked forother hackers — both ethical and unethical. You can tailor these same tricksand techniques to specific situations.56 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 56

57 Chapter 5: Social Engineering
A case study in social engineering
with Ira Winkler
In this case study, Ira Winkler, a world-renowned
social engineer, was gracious in sharing withme an interesting study in social engineering.
The SituationMr. Winkler’s client wanted a general tempera-
ture of the organization’s security awarenesslevel. He and his accomplice went for the pot ofgold and tested the organization’s susceptibilityto social engineering. Getting started, theyscoped out the main entrance of the client’sbuilding and found that the reception/securitydesk was in the middle of a large lobby and wasstaffed by a receptionist. The next day, the twomen walked into the building during the morn-ing rush while pretending to talk on cell phones.They stayed at least 15 feet from the attendantand simply ignored her as they walked by.
After they were inside the facility, they found a
conference room to set up shop. They sat downto plan the rest of the day and decided a facilitybadge would be a great start. Mr. Winkler calledthe main information number and asked for theoffice that makes the badges. He was forwardedto the reception/security desk. He then pre-tended to be the CIO and told the person onthe other end of the line that he wanted badgesfor a couple of subcontractors. The personresponded, “Send the subcontractors down tothe main lobby.”
When Mr. Winkler and his accomplice arrived,
a uniformed guard asked what they were work-ing on, and they mentioned computers. Theguard then asked them if they needed access tothe computer room! Of course they said, “Thatwould help.” Within minutes, they both hadbadges with access to all office areas and thecomputer operations center. They went to thebasement and used their badges to open themain computer room door. They walked right inand were able to access a Windows server,load the user administration tool, add a newuser to the domain, and make the user amember of the administrators’ group. Then theyquickly left. 
The two men had access to the entire corporate
network with administrative rights within twohours! They also used the badges to performafter-hours walkthroughs of the building. Indoing this, they found the key to the CEO’s officeand planted a mock bug there. 
The OutcomeNobody outside the team knew what the two
men did until they were told after the fact. Afterthe employees were informed, the guard super-visor called Mr. Winkler and wanted to knowwho issued the badges. Mr. Winkler informedhim that the fact that his area didn’t know whoissued the badges was a problem in and ofitself, and that he does not disclose that infor-mation.
How This Could Have Been PreventedAccording to Mr. Winkler, the security desk
should have been located closer to the entrance,and the company should have had a formalprocess for issuing badges. In addition, accessto special areas like the computer room shouldrequire approval from a known entity. Afteraccess is granted, a confirmation should besent to the approver. Also, the server screenshould have been locked, the account shouldnot have been logged on unattended, and anyaddition of an administrator-level account shouldbe audited and appropriate parties should bealerted.
Ira Winkler, CISSP , CISM, is considered one of
the world’s best social engineers. You can findmore of his case studies in his book Spies
Among Us (McGraw-Hill).09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 57

Free ebooks ==>   www.Ebook777.com
These social-engineering techniques may be best performed by an outsider
to the organization. If you’re performing these tests against your own organi-zation, you may have difficulties acting as an outsider if everyone knows you.This may not be a problem in larger organizations, but if you have a small,close-knit company, people usually are on to your antics.
You can outsource social-engineering testing to a trusted consulting firm or
even have a colleague perform the tests for you. The key word here is trusted .
If you’re involving someone else, you must get references, perform backgroundchecks, and have the testing approved by management in writing beforehand.I cover the topic of outsourcing ethical hacking in Chapter 19.
Why Hackers Use Social Engineering
Bad guys use social engineering to break into systems because they can. They
want someone to open the door to the organization so that they don’t have tobreak in and risk getting caught. Firewalls, access controls, and authentica tion
devices can’t stop a determined social engineer.
Most social engineers perform their attacks slowly, so they’re not so obvious
and don’t raise suspicion. The bad guys gather bits of information over timeand use the information to create a broader picture. Alternatively, some social-engineering attacks can be performed with a quick phone call or e-mail. Themethods used depend on the hacker’s style and abilities.
Social engineers know that many organizations don’t have formal data classi-
fication, access-control systems, incident-response plans, and security-awareness programs.
Social engineers know a lot about a lot of things — both inside and outside
their target organizations — because it helps them in their efforts. The moreinformation social engineers gain about organizations, the easier it is for themto pose as employees or other trusted insiders. Social engineers’ knowledgeand determination give them the upper hand over average employees whoare unaware of the value of the information social engineers are seeking.
Understanding the Implications
Most organizations have enemies that want to cause trouble through socialengineering. These enemies could be current or former employees seekingrevenge, competitors wanting a leg up, or basic hackers trying to prove theirskills.58 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 58
www.Ebook777.com


Regardless of who is causing the trouble, every organization is at risk. Larger
companies spread across several locations are often more vulnerable, butsmall companies also are attacked. Everyone from receptionists to securityguards to IT personnel are potential victims of social engineering. Help-deskand call-center employees are especially vulnerable because they are trainedto be helpful and forthcoming with information. Even the average untrainedend user is susceptible to attack.
Social engineering has serious consequences. Because the objective of social
engineering is to coerce someone for ill-gotten gains, anything is possible.Effective social engineers can obtain the following information:
/H12012User or administrator passwords
/H12012Security badges or keys to the building and even the computer room
/H12012Intellectual property such as design specifications, formulae, or otherresearch and development documentation
/H12012Confidential financial reports
/H12012Private and confidential employee information
/H12012Customer lists and sales prospects
If any of the preceding information is leaked out, it can cause financial losses,lower employee morale, jeopardize customer loyalty, and even create legalissues. The possibilities are endless.
One reason protecting against social-engineering attacks is difficult is that they
aren’t well documented. Because so many possible methods exist, recoveryand protection are difficult after the attack. The hard crunchy outside created by
firewalls and intrusion-detection systems often creates a false sense of security,making the problem even worse.
With social engineering, you never know the next method of attack. The best
you can do is remain vigilant, understand the social engineer’s methodology,and protect against the most common attacks. In the rest of this chapter, Idiscuss how you can do this.
Performing Social-Engineering Attacks
The process of social engineering is actually pretty basic. In general, socialengineers find the details of organizational processes and information systemsto perform their attacks. With this information, they know what to pursue.Hackers typically perform social-engineering attacks in four simple steps:59 Chapter 5: Social Engineering09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 59

Free ebooks ==>   www.Ebook777.com
1. Perform research.
2. Build trust.3. Exploit relationship for information through words, actions, or 
technology.
4. Use the information gathered for malicious purposes.
These steps can include myriad substeps and techniques, depending on the
attack being performed.
Before social engineers perform their attacks, they need a goal in mind. This
is the hacker’s first step in this process, and this goal is most likely alreadyimplanted in the hacker’s mind. What does the hacker want to accomplish?What is the hacker trying to hack? Does he want intellectual property, serverpasswords, or security badges; or does he simply want to prove that thecompany’s defenses can be penetrated? In your efforts as an ethical hackerperforming social engineering, determine this goal before you move forward.
Fishing for information
Social engineers typically start by gathering public information about theirvictim. Many social engineers acquire information slowly over time so theydon’t raise suspicion. Obviousness is a tip-off when defending against socialengineering. I cover other warning signs throughout the rest of this chapter.
Regardless of the initial research method, all a hacker needs to start penetrat-
ing an organization is an employee list, a few key internal phone numbers, ora company calendar.
Using the Internet
Today’s basic research medium is the Internet. A few minutes on Google orother search engines, using simple key words such as the company name orspecific employees’ names, often produces a lot of information. You can findeven more information in SEC filings at 
www.sec.gov and at sites such as
www.hoovers.com and finance.yahoo.com . In fact, many organizations —
especially upper management — would be dismayed by what’s available. Byusing this search-engine information and browsing the company’s Web site,the hacker often has enough information to start.
Hackers can pay $100 or less for a comprehensive background check on indi-
viduals. These searches can turn up practically any public — and sometimesprivate — information about a person in minutes.60 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 60
www.Ebook777.com


Dumpster diving
Dumpster diving is a more difficult method of obtaining information. This
method is literally going through trash cans for information about a company.
Dumpster diving can turn up even the most confidential information, because
many employees think that their information is safe after it goes into file 13.Most people don’t think about the potential value of paper they throw away.These documents often contain a wealth of information that tips off the socialengineer with information needed to penetrate the organization further. Theastute social engineer looks for the following printed documents:
/H12012Internal phone lists
/H12012Organizational charts
/H12012Employee handbooks, which often contain security policies
/H12012Network diagrams
/H12012Password lists
/H12012Meeting notes
/H12012Spreadsheets and reports
/H12012E-mails containing confidential information
Shredding is effective if the paper is cross-shredded into tiny pieces of con-
fetti. Inexpensive shredders that shred documents only in long strips arebasically worthless against a determined social engineer. With a little timeand tape, a social engineer can easily piece a document back together.
Hackers often gather confidential personal and business information from
others by listening in on conversations held in restaurants, coffee shops, andairports. People who speak loudly when talking on a cell phone are a greatsource. Poetic justice, perhaps? While writing in public places, it’s amazingwhat I’ve heard others divulge — and I wasn’t trying to listen!
Hackers also look for floppy disks, CD-ROM and DVD discs, old computer
cases (especially with hard drives) and backup tapes.
See Chapter 6 for more on trash and other physical-security issues, including
countermeasures against these exploits.
Phone systems
Hackers can obtain information by using the dial-by-name feature built intomost voice-mail systems. To access this feature, you usually just press 061 Chapter 5: Social Engineering09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 61

when calling into the company’s main number or even someone’s desk. This
trick works best after hours to make sure that no one answers.
Hackers can protect their identifies if they can hide where they’re calling
from. Here are some ways that they can do that:
/H12012Residential phones sometimes can hide their numbers from caller ID.
The code to hide a residential phone number from a caller ID is *67. Justdial *67 before the number; it blocks the source number.
This feature is usually disabled when you’re calling toll-free (800, 888, 877)
numbers.
/H12012Business phones are more difficult to spoof from an office by using a
phone switch. However, all the hacker usually needs is the user guideand administrator password for the phone-switch software. In manyswitches, the hacker can enter the source number — including a falsifiednumber, such as the victim’s home phone number.
Hackers find interesting bits of information, such as when their victims are outof town, just by listening to voice-mail messages. They even study victims’voices by listening to their voice-mail messages or Internet presentations andWebcasts to impersonate those people.
Building trust
Trust — so hard to gain, so easy to lose. Trust is the essence of social engi-neering. Most humans trust other humans until a situation occurs that forcesthem not to. We want to help one another, especially if trust can be built andthe request for help is reasonable. Most people want to be team players in theworkplace and don’t know what can happen if they divulge too much informa-tion to a “trusted” source. This is why social engineers can accomplish theirgoals. Of course, building deep trust often takes time. Crafty social engineersgain it within minutes or hours. How do they build trust?
/H12012Likability: Who can’t relate to a nice person? Everyone loves courtesy.
The friendlier the social engineer — without going overboard — thebetter his chances of getting what he wants. Social engineers often beginby establishing common interests. They often use information theygained in the research phase to determine what the victim likes and actas if they like those things as well. For instance, they can phone victimsor meet them in person and, based on information they’ve learned aboutthe person, start talking about local sports teams or how wonderful it isto be single again. A few low-key and well-articulated comments can bethe start of a nice new relationship.62 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 62

/H12012Believability: Of course, believability is based in part on the knowledge
that social engineers have and how likable they are. But social engineers
also use impersonation — perhaps posing as a new employee or fellowemployee that the victim hasn’t met. They may even pose as a vendorthat does business with the organization. They often modestly claimauthority to influence people. The most common social-engineering trickis to do something nice so that the victim feels obligated to be nice inreturn or to be a team player for the organization.
Exploiting the relationship
After social engineers obtain the trust of their unsuspecting victims, theycoax them into divulging more information than they should. Whammo —they can go in for the kill. They do this through face-to-face or electroniccommunications that victims feel comfortable with, or they use technologyto get victims to divulge information.
Deceit through words and actions
Wily social engineers can get inside information from their victims many ways.They are often articulate and focus on keeping their conversations movingwithout giving their victims much time to think about what they’re saying.However, if they’re careless or overly anxious during their social-engineeringattacks, the following tip-offs may give them away:
/H12012Acting overly friendly or eager
/H12012Mentioning names of prominent people within the organization
/H12012Bragging about authority within the organization
/H12012Threatening reprimands if requests aren’t honored
/H12012Acting nervous when questioned (pursing the lips and fidgeting — especially the hands and feet, because more conscious effort is requiredto control body parts that are farther from the face)
/H12012Overemphasizing details
/H12012Physiological changes, such as dilated pupils or changes in voice pitch
/H12012Appearing rushed
/H12012Refusing to give information
/H12012Volunteering information and answering unasked questions 
/H12012Knowing information that an outsider should not have
/H12012A known outsider using insider speech or slang63 Chapter 5: Social Engineering09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 63

Free ebooks ==>   www.Ebook777.com
/H12012Asking strange questions
/H12012Misspelling words in written communications
A good social engineer isn’t obvious with the preceding actions, but these are
some of the signs that malicious behavior is in the works.
Hackers often do a favor for someone and then turn around and ask that person
if he or she would mind helping them. This is a common social-engineering
trick that works pretty well. Hackers also often use what’s called reverse socialengineering. This is where they offer help if a specific problem arises; sometime passes, the problem occurs (often by their doing), and then they help fixthe problem. They may come across as heroes, which can further their cause.Hackers also simply may ask an unsuspecting employee for a favor. Yes —they just outright ask for a favor. Many people fall for it.
Impersonating an employee is easy. Social engineers can wear a similar look-
ing uniform, make a fake ID badge, or simply dress like the real employees.They often pose as employees. People think, “Hey — he looks and acts likeme, so he must be one of us.” Social engineers also pretend to be employeescalling in from an outside phone line. This is an especially popular way ofexploiting help-desk and call-center personnel. Hackers know that it’s easyfor these people to fall into a rut due to such repetitive tasks as saying,“Hello, can I get your customer number, please?”
Here’s my story about how I was social-engineered because I didn’t think
before I spoke. One day, I was having trouble with my high-speed Internetconnection. I figured I could just use dial-up access, because it’s better thannothing for e-mail and other basic tasks. I contacted my ISP and told the tech-support guy I couldn’t remember my dial-up password. This sounds like thebeginning of a social-engineering stunt that I could’ve pulled off, but I got
taken. The slick tech-support guy paused for a minute, as if he was pulling upmy account info, and then asked, “What password did you try?”
Stupid me, I proceeded to mouth off all the passwords it could’ve been! The
phone got quiet for a moment. He reset my password and told me what itwas. After I hung up the phone, I thought, “What just happened? I just gotsocial-engineered!” Man, was I mad at myself. I changed all the passwordsthat I divulged in case he used that information against me. I still bet to thisday that he was just experimenting with me. Lesson learned: Never, ever,under any circumstances divulge your password to someone else.
Deceit through technology
Technology can make things easier — and more fun — for the social engineer.Often, the request comes from a computer or other electronic entity youthink you can identify. But spoofing a computer name, an e-mail address, a faxnumber, or a network address is easy. Fortunately, you can take a few counter-measures against this, as described in the next section.64 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 64
www.Ebook777.com


One way hackers deceive through technology is by sending e-mail for critical
information. Such e-mail usually provides a link that directs victims to a pro-fessional- and legitimate-looking Web site that “updates” such account infor-mation as user IDs, passwords, and Social Security numbers
Many spam messages use this trick. Most users are inundated with so much
spam and other unwanted e-mail that they often let their guard down and opene-mails and attachments that they shouldn’t open. These e-mails usually lookprofessional and believable. They often dupe people into disclosing informa-tion they should never give in exchange for a gift. These social-engineeringtricks also occur when a hacker who has already broken into the networksends messages or creates fake Internet pop-up windows. The same trickshave occurred through instant messaging and cell-phone messaging.
In some well-publicized incidents, hackers e-mailed to their victims a patch
purporting to come from Microsoft or another well-known vendor. Users thinkit looks like a duck and it quacks like a duck — but it’s not Bill this time! Themessage is from a hacker wanting the user to install the “patch” so a Trojan-horse keylogger can be installed or a backdoor can be created into computers
and networks. Hackers use these backdoors to hack into the organization’ssystems or use the victims’ computers (known as zombies ) as launching pads
to attack another system. Even viruses or worms use social engineering. Forinstance, the LoveBug worm told users they had a secret admirer. When thevictims opened the e-mail, it was too late. Their computers were infected;perhaps worse, they didn’t have a secret admirer.
The Nigerian 419 e-mail fraud scheme attempts to access unsuspecting
people’s bank accounts and money. These social engineers — scamsters —
offer to transfer millions of dollars to the victim to repatriate a deceasedclient’s funds to the United States. All the victim must provide is personalbank-account information and a little money up front to cover the transferexpenses. Victims have ended up having their bank accounts emptied.
Many computerized social-engineering tactics can be performed anonymously
through Internet proxy servers, anonymizers, and remailers. When people fallfor requests for confidential personal or corporate information, the sourcesof these social-engineering attacks are often impossible to track.
Social-Engineering Countermeasures
You have only a few good lines of defense against social engineering. Even withstrong security systems, a naïve or untrained user can let the social engineerinto the network. Never underestimate the power of social engineers.65 Chapter 5: Social Engineering09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 65

Policies
Specific policies help ward off social engineering long-term in these areas:
/H12012Classifying data
/H12012Hiring employees and contractors and setting up user IDs
/H12012Terminating employees and contractors, and removing user IDs
/H12012Setting and resetting passwords
/H12012Handling proprietary and confidential information
/H12012Escorting guests
These policies must be enforceable and enforced — for everyone within the
organization. Keep them up to date and tell your end users about them.
User awareness
The best line of defense against social engineering is an organization withemployees who can identify and respond to social-engineering attacks. Userawareness begins with initial training for everyone and follows with security-awareness initiatives to keep social-engineering defenses on everyone’s mind.Align training and awareness with specific security policies.
Consider outsourcing security training to a seasoned security trainer.
Employees often take training more seriously if it comes from an outsider.Outsourcing security training is worth the investment.
As you approach ongoing user training and awareness in your organization,
the following tips help you combat social-engineering long term:
/H12012Treat security awareness and training as a business investment.
/H12012Train users on an ongoing basis to keep security fresh in their minds.
/H12012Tailor your training content to your audience whenever possible.
/H12012Create a social-engineering awareness program for your business func-tions and user roles.
/H12012Keep your messages as nontechnical as possible.
/H12012Develop incentive programs for preventing and reporting incidents.
/H12012Lead by example.66 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 66

Share these tips with your users to help prevent social-engineering attacks:
/H12012Never divulge any information unless you can validate that the person
requesting the information needs it and is who he says he is. If a requestis made over the telephone, verify the caller’s identity, and call back.
/H12012Never click an e-mail link that supposedly loads a page with informationthat needs updating. This is especially true for unsolicited e-mails.
/H12012Escort all guests within a building.
/H12012Never send or open files from strangers.
/H12012Never give out passwords.
A few other general suggestions can ward off social engineering:
/H12012Never let a stranger connect to one of your network jacks — even for afew seconds. A hacker can place a network analyzer, Trojan-horse pro-gram, or other malware directly onto your network.
/H12012Classify your information assets, both hard-copy and electronic. Trainall employees to handle each asset type.
/H12012Develop and enforce computer media and document destruction policiesthat help ensure data is handled carefully and stays where it should.
/H12012Use cross-shredding paper shredders. Better, hire a document-shreddingcompany that specializes in confidential document destruction.
/H12012Never allow anonymous File Transfer Protocol (FTP) access into yourFTP servers if you don’t have to.
These techniques can reinforce the content of formal training:
/H12012New-employee orientation, lunch ’n’ learns, e-mails, and newsletters
/H12012Social-engineering survival brochure with tips and FAQs
/H12012Trinkets, such as screen savers, mouse pads, sticky notes, pens, andoffice posters
Appendix A lists my favorite user-awareness trinket vendors to improve
user awareness in your organization.67 Chapter 5: Social Engineering09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 67

Free ebooks ==>   www.Ebook777.com
68 Part II: Putting Ethical Hacking in Motion 09 55784x Ch05.qxd  3/29/04  4:15 PM  Page 68
www.Ebook777.com


Chapter 6
Physical Security
In This Chapter
/H17075Understanding the importance of physical security
/H17075Q&A with a well-known physical-security expert
/H17075Looking for physical-security vulnerabilities
/H17075Implementing countermeasures for physical-security attacks
I’m a strong believer that information security is more dependent on non-
technical policies, processes, and procedures than on the technical 
hardware and software solutions that many people swear by. Physical security — protection of physical property — encompasses both technical and
nontechnical components.
Physical security is an often overlooked aspect of an information-security
program. Physical security is a critical component of information security.Your ability to secure your information depends on your ability to secureyour site physically. In this chapter, I cover some common physical-securityweaknesses, as they relate to computers and information security, to look forin your own systems. In addition, I outline free and low-cost countermeasuresto minimize your vulnerabilities. I don’t recommend breaking and entering,which is required for some physical-security tests. Instead, approach sensi-tive areas to see how far you canget. Take a fresh look — from an outsider’s
perspective — at the physical vulnerabilities I cover in this chapter. You maydiscover holes in your physical-security infrastructure.
Physical-Security Vulnerabilities
Whatever your computer and network-security technology, practically anyhack is possible if a hacker is in your building or computer room. That’s whyit’s important to look for physical-security vulnerabilities.10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 69

Free ebooks ==>   www.Ebook777.com
In small companies, some physical-security issues may not be a problem.
Many physical security vulnerabilities depend on factors like the following:
/H12012Size of the building
/H12012Number of buildings or sites
/H12012Number of employees
/H12012Location and number of building entrance/exit points
/H12012Placement of the computer room(s) and other confidential information
Literally thousands of possible physical-security vulnerabilities exist. Thebad guys are always on the lookout for them — so you should find these vul-nerabilities first. Here are some common physical-security vulnerabilities I’vefound when assessing security:
/H12012No receptionist in a building
/H12012No visitor sign-in or escort required for building access
/H12012Employees trusting visitors just because they’re wearing vendor uni-forms or say they’re there to work on the copier or computers
/H12012No access controls on doors
/H12012Doors propped open
/H12012Publicly accessible computer rooms
/H12012Backup media lying around
/H12012Unsecured computer hardware and software media
/H12012CDs and floppy disks with confidential information in trash cans
When these physical-security vulnerabilities are exploited, bad things canhappen. Perhaps the biggest problem is that unauthorized people can enteryour building. After intruders are in your building, they can wander the halls;log onto computers; rummage through the trash; and steal hard-copy docu-ments, floppy disks and CDs, and even computers out of offices.
What to Look For
You should look for specific security vulnerabilities. Many potential physical-security exploits seem unlikely, but they happen to organizations that don’ttake physical security seriously.
Hackers can exploit many physical-security vulnerabilities, including weak-
nesses in a building’s infrastructure, office layout, computer-room access,and design. In addition to these factors, consider the facility’s proximity to70 Part II: Putting Ethical Hacking in Motion 10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 70
www.Ebook777.com


local emergency assistance (police, fire, and ambulance) and the area’s crime
statistics (burglary, breaking and entering, and so on) so you can better under-stand what you’re up against.71 Chapter 6: Physical Security
A Q&A on physical security with Jack Wiles
In this Q&A session, Jack Wiles, an information-security pioneer with over 30 years of experi-ence, answered several questions on physicalsecurity and how a lack of it often leads to infor-mation insecurity.
How important do you think physical security
is in relation to technical-security issues?
I’ve been asked that question many times in the
past, and from decades of experience with bothphysical and technical security, I have a stan-dard answer. Without question, many of themost expensive technical-security counter-measures and tools become worthless whenphysical security is weak. If I can get my teaminto your building(s) and walk up to someone’sdesk and log in as that person, I have bypassedall your technical-security systems. In pastsecurity assessments, after my team and Ientered a building, we always found that peoplesimply thought that we belonged there — thatwe were employees. We were always friendlyand helpful when we came in contact with realemployees. They would often return the kind-ness by helping us with whatever we asked for.
How were you able to get into most of the
buildings when you conducted “red team” pen-etration tests for companies?
In many cases, we just boldly walked into the
building and went up the elevator in multistorybuildings. If we were challenged, we alwayshad a story ready. Our typical story was that wethought that this was the HR department, andwe were there to apply for a job. If we werestopped at the door and told which building togo to for HR, we simply left and then looked forother entrances to that same building. If wefound an outside smoking area at a differentdoor, we attempted tailgating and simply walked
in behind other employees who were reenter-ing the building after finishing their breaks.Tailgating also worked at most entrances thatrequired card access. In my career as a red-team leader, we were never stopped and ques-tioned. We simply said, “Thank you” as wewalked in and compromised the entire building.
What kinds of things would you bring out of a
building?
It was always easy to get enough important
documentation to prove that we were there. Inmany cases, the documentation was sitting in abox next to someone’s desk (especially if thatperson was someone important) marked RECY-CLE. To us, that really said, “Steal me first”! Wefound it interesting that many companies just lettheir recycle boxes fill up before emptying them.We would also look for a room where strip-cutshredders were used. The documents that wereshredded were usually stored in clear plasticbags. We loaded these bags into our cars andhad many of the shredded documents put backtogether in a few hours. We found that if wepasted the strips from any page on cardboardwith as much as an inch of space between thestrips, the final document was still readable.
Jack Wiles is president of TheTrainingCo.
and promotes the annual information-
security conference Techno Security (
www.
thetrainingco.com ).10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 71

The following sections list vulnerabilities to look for when assessing your orga-
nization’s physical security. This won’t take a lot of technical savvy or expen-sive equipment. Depending on the size of your facilities, these tests shouldn’ttake much time. The bottom line is to determine whether the physical-secu rity
systems are adequate for the risks involved. Above all, be practical and usecommon sense.
Building infrastructure
Doors, windows, and walls are critical components of a building — especiallyin a computer room or in an area where confidential information is stored.
Attack points
Hackers can exploit a handful of building-infrastructure vulnerabilities.Consider the following attack points, which are commonly overlooked:
/H12012Are doors propped open? If so, why?
/H12012Can gaps at the bottom of critical doors allow someone using a balloonor other device to trip a sensor on the inside of a “secure” room?
/H12012Would it be easy to force doors open? Would a simple kick near thedoorknob suffice?
/H12012What is the building and/or computer room made of (steel, wood, con-crete), and how sturdy are the walls and entryways? How resilient wouldthe material be to earthquakes, tornadoes, strong winds, heavy rains,and vehicles driving into the building?
/H12012Are any doors or windows made of glass? Is this glass clear? Is the glassshatterproof or bulletproof?
/H12012Are doors, windows, and other entry points wired to an alarm system?
/H12012Are there drop ceilings with tiles that can be pushed up? Are the walls
slab-to-slab? If not, hackers can easily scale walls, bypassing any door orwindow access controls.
Countermeasures
Many physical-security countermeasures for building vulnerabilities mayrequire other maintenance, construction, or operations experts. If buildinginfrastructures is not your forte, you can hire outside experts during thedesign, assessment, and retrofitting stages to ensure that you have adequatecontrols. Here are some of the best ways to solidify building security:
/H12012Strong doors and locks
/H12012Windowless walls around computer rooms72 Part II: Putting Ethical Hacking in Motion 10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 72

Free ebooks ==>   www.Ebook777.com
/H12012An alarm system that’s connected to all access points and continuously
monitored
/H12012Lighting (especially around entry/exit points)
/H12012Mantraps that allow only person at a time to pass through a door
/H12012Fences (barbed wire and razor wire)
Utilities
You must consider building and computer-room utilities, such as power,water, and fire suppression, when accessing physical security. These utilitiescan help fight off such incidents as fire and keep other access controls run-ning during a power loss. They can also be used against you if an intruderenters the building.
Attack points
Hackers often exploit utility-related vulnerabilities. Consider the followingattack points, which are commonly overlooked:
/H12012Is power-protection equipment (surge protectors, UPSs, and generators)in place? How easily accessible are the on/off switches on these devices?Can an intruder walk in and flip a switch?
/H12012When the power fails, what happens to physical-security mechanisms?Do they fail open, allowing anyone through, or fail closed, keeping every-
one in or out until the power is restored?
/H12012Where are fire-detection and -suppression devices — including alarmsensors, extinguishers, and sprinkler systems — located? Determinehow a malicious intruder can abuse them. Are these devices placedwhere they can harm electronic equipment during a false alarm?
/H12012Where are water and gas shutoff valves located? Can you access them,or would you have to call maintenance personnel about an incident?
/H12012Are local telecom wires (both copper and fiber) that run outside of thebuilding located aboveground, where someone can tap into them withtelecom tools? Can digging in the area cut them easily? Are they locatedon telephone poles that are vulnerable to traffic accidents?
Countermeasures
You may need to involve other experts during the design, assessment, orretrofitting stages. The key is placement:
/H12012Where are the major utility controls placed?
/H12012Can a hacker or other miscreant walking through the building access thecontrols to turn them on and off?73 Chapter 6: Physical Security10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 73
www.Ebook777.com


Covers for on/off switches and thermostat controls and locks for server
power buttons and PCI expansion slots are effective defenses.
I once assessed the physical security of an Internet collocation facility for a
very large computer company (whose name will remain anonymous). I made itpast the front guard and tailgated through all the controlled doors to reach thedata center. After I was inside, I walked by such equipment as servers, routers,firewalls, UPSs, and power cords that were owned by very large dot-com com-panies. All this equipment was completely exposed to anyone walking in thatarea. A quick flip of a switch or an accidental trip over a network cable dan-gling to the floor could bring an entire shelf — and a global e-commerce site —to the ground.
Office layout and usage
Office design and usage can either help or hinder physical security.
Hackers may exploit some office vulnerabilities. Consider these attack points:
/H12012Does a receptionist or security guard monitor traffic in and out?
/H12012Do employees have confidential information on their desks? What about
mail and other packages — do they lie around outside someone’s dooror, even worse, outside the building, waiting for pickup?
/H12012Where are trash cans and dumpsters located? Are they easily accessibleby anyone? Are recycling bins or shredders used? Open recycling binsand other careless handling of trash are open invitations for dumpster
diving — in which hackers search for confidential company information
in phone lists and memos in the trash. Dumpster diving can lead tomany security exposures.
/H12012How secure are mail and copy rooms? If hackers can access theserooms, they can steal mail or company letterhead to use against you.
/H12012Are closed-circuit television (CCTV) cameras used andmonitored?
/H12012What access controls are on doors and windows? Are regular keys, cardkeys, combination locks, or biometrics used? Who can access these keys,and where are they stored? Keys and programmable keypad combinationsare often shared among users, making accountability difficult to deter-
mine. Find out how many people share these combinations and keys.
Countermeasures
Simple measures can reduce your exposure to office vulnerabilities:74 Part II: Putting Ethical Hacking in Motion 10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 74

/H12012A receptionist or a security guard who monitors people coming and going.
This is the most critical countermeasure. This person can ensure thatevery visitor signs in and that all new or untrusted visitors are alwaysescorted.
Make it policy and procedure for all employees to question strangers
and report strange behavior in the building.
Employees Only or Authorized Personnel Only signs show the bad guys
where they should go instead of deterring them from entering.
/H12012CCTV cameras.
/H12012Single entry/exit points to a building or computer room.
/H12012Secure areas for dumpsters.
/H12012Cross-cut shredders or secure recycling bins for hard-copy documents.
/H12012Limited numbers of keys and pass-code combinations.Make keys and pass codes unique for each person, whenever possible.
/H12012Biometrics identification systems can be very effective, but they can
also be expensive and difficult to manage.
Network components and computers
After hackers obtain physical access to a building, they look for the computerroom and other easily accessible computer and network devices.
Attack points
The keys to the kingdom are often as close as someone’s desktop computerand not much farther than an unsecured computer room or wiring closet.
Malicious intruders can do the following:
/H12012Obtain network access and send malicious e-mails as a logged-in user.
/H12012Steal files from the computer by copying them onto a floppy disk or USB
drive, or by e-mailing them to an external address.
/H12012Enter unlocked computer rooms and mess around with servers, firewalls,and routers.
/H12012Walk out with network diagrams, contact lists, and business-continuityand incident-response plans.
/H12012Obtain phone numbers from analog lines and circuit IDs from T1, frame-relay, and other telecom equipment for future attacks.75 Chapter 6: Physical Security10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 75

Practically every bit of unencrypted information that traverses the network
can be recorded for future analysis through one of the following methods:
/H12012Connecting a computer running network-analyzer software to a hub,monitor, or mirrored port on a switch on your network
/H12012Installing network-analyzer software on an existing computer.
This is very hard to spot.
How would hackers access this information in the future?
/H12012The easiest attack method is to either install remote-administration soft-
ware on the computer or dial into a modem by using VNC orpcAnywhere.
/H12012A crafty hacker with enough time can bind a public IP address to thecomputer if it’s outside the firewall. Hackers with enough networkknowledge can configure new firewall rules to do this.
Also consider these other vulnerabilities:
/H12012How easily can someone’s computer be accessed during regular hours?During lunchtime? After hours?
/H12012Are servers, firewalls, routers, and switches mounted in locked racks?
/H12012Are computers — especially laptops — secured to desks with locks?
/H12012Are passwords stored on sticky notes on computer screens, keyboards,or desks?
/H12012Are backup media lying around the computer room susceptible to theft?
/H12012Are media safes used to protect backup media? Who can access the safe?
/H12012How are laptops and hand-held computers handled in-house and whenemployees are working from home or traveling? Are personal digitalassistants (PDAs) and cell phones sitting around unsecured? Thesedevices are often at great risk because of their size and value. Also, theyare typically unprotected by the organization’s regular security controls.Are specific policies and technologies in place to help protect them? Islocking laptop bags and PDA cases required? What about power-on pass-words? Also consider encryption in case these devices get into ahacker’s hands.
/H12012How easily can someone access a wireless access point (AP) signal or the
AP itself to join the network?
/H12012Are network firewalls, routers, switches, and hubs (basically, anythingwith an Ethernet connection) easily accessible, which would enable ahacker to plug into the network easily?76 Part II: Putting Ethical Hacking in Motion 10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 76

/H12012Are all cables patched through on the patch panel in the wiring closet so
all network drops are live?
This is very common but a bad idea.
/H12012Are cable traps/locks in place that prevent hackers from unplugging net-
work cables from patch panels or computers to use those connectionsfor their own computers?
Countermeasures
Network and computer security countermeasures are some of the simplest toimplement, yet the most difficult to enforce because they involve everydayactions. Here is a rundown of these countermeasures:
/H12012Require users to lock their screens — which usually takes a few clicks orkeystrokes in Windows or UNIX — to keep intruders out of their systems.
/H12012Ensure that strong passwords are used (as covered in Chapter 7).
/H12012Require laptop users to lock their systems to their desks with a lockingcable. This is especially important in larger companies or locations thatreceive a lot of foot traffic.
/H12012Keep computer rooms and wiring closets locked, and monitor thoseareas for malicious wrongdoings.
/H12012Keep a current inventory of hardware and software within the organiza-tion — especially in computer rooms — so it’s easy to determine whenextra equipment appears or other equipment is missing.
/H12012Properly secure computer media — such as floppy disks, CD-ROMs,tapes, and hard drives — when stored and during transport.
/H12012Use a bulk eraser on magnetic media before it’s discarded.77 Chapter 6: Physical Security10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 77

Free ebooks ==>   www.Ebook777.com
78 Part II: Putting Ethical Hacking in Motion 10 55784x Ch06.qxd  3/29/04  4:15 PM  Page 78
www.Ebook777.com



[Note: PDF has 386 pages, only first 100 pages extracted]